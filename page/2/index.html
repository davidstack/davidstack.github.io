<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.1.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"damonyi.cc","root":"/","images":"/images","scheme":"Muse","version":"8.1.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>
<meta name="description" content="雾里云里">
<meta property="og:type" content="website">
<meta property="og:title" content="云里雾里">
<meta property="og:url" content="http://damonyi.cc/page/2/index.html">
<meta property="og:site_name" content="云里雾里">
<meta property="og:description" content="雾里云里">
<meta property="og:locale" content="zh_CN">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://damonyi.cc/page/2/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>
<title>云里雾里</title>
  



  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">云里雾里</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <section class="post-toc-wrap sidebar-panel">
        </section>
        <!--/noindex-->

        <section class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description">雾里云里</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">50</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



        </section>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Docker%E5%87%A0%E4%B8%AA%E4%B8%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Docker%E5%87%A0%E4%B8%AA%E4%B8%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">Docker几个不常用的命令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:44:34 / 修改时间：19:59:12" itemprop="dateCreated datePublished" datetime="2020-09-21T19:44:34+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Docker不太常用的命令"><a href="#Docker不太常用的命令" class="headerlink" title="Docker不太常用的命令"></a>Docker不太常用的命令</h2><ul>
<li>docker ps -s #查看容器所占的磁盘大小</li>
<li>docker rm ${docker ps -q -a} # 删除全部非运行态的容器</li>
<li>docker system df #查看docker存储的使用情况</li>
<li>docker system prun #清理无用的容器、网络、数据集</li>
<li>docker rmi $(docker images | awk ‘/^<none>/ { print $3 }’) #删除的镜像repositry为none的镜像</none></li>
</ul>
<h2 id="Docker配置参数"><a href="#Docker配置参数" class="headerlink" title="Docker配置参数"></a>Docker配置参数</h2><ol>
<li>--iptables ,该参数用于控制是否允许docker去管理iptables，当设置为true时，允许docker去管理iptbales表<ul>
<li>通常在docker单独使用时，需要这样配置，如果配置为false，iptables被清空后，是无法自动创建的</li>
<li>在基于Kubernetes等管理docker时，可以配置iptables=false</li>
</ul>
</li>
<li>--ip-forward，该参数用于控主机容器与外部网络之间的相互通信，当设置为true时，允许容器被外部访问，当设置为false时，外部是无法访问到容器<ul>
<li>当宿主机设置了ip_forward参数为1时，会以宿主机的配置为准，docker的改配置参数无效</li>
</ul>
</li>
</ol>
<h2 id="迁移Docker存储方式一"><a href="#迁移Docker存储方式一" class="headerlink" title="迁移Docker存储方式一"></a>迁移Docker存储方式一</h2><p>若Docker已经运行一段时间，并存在运行的容器，可以采用以下方法进行容器存储的迁移</p>
<ol>
<li>停止全部容器</li>
<li>停止docker：systemctl stop docker</li>
<li>mkdir -p /sl/docker/</li>
<li>移动docker存储：mv /var/lib/docker/* /sl/docker/</li>
<li>建立软连接：ln -s /sl/docker /var/lib/</li>
<li>systemctl start docker</li>
</ol>
<p>注意删除软连接是 rm /var/lib/docker 后面不能有斜杠，否则是删除整个目录)</p>
<h2 id="迁移Docker存储方式二"><a href="#迁移Docker存储方式二" class="headerlink" title="迁移Docker存储方式二"></a>迁移Docker存储方式二</h2><ol>
<li>停止全部容器</li>
<li>停止docker：systemctl stop docker</li>
<li>cd /sl</li>
<li>mkdir dockerdaemon</li>
<li>cd /sl/dockerdaemon</li>
<li>tar -czvpf docker.tar.gz /var/lib/docker</li>
<li>tar zxvf docker.tar.gz -C /sl/dockerdaemon</li>
<li>cd /sl/dockerdaemon/var/lib/</li>
<li>mv docker/ ../../</li>
<li>mv /var/lib/docker /sl/backup</li>
<li>ln -s /sl/dockerdaemon/docker /var/lib/</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Docker%E5%AE%B9%E5%99%A8%E5%86%85%E7%9A%84%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Docker%E5%AE%B9%E5%99%A8%E5%86%85%E7%9A%84%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/" class="post-title-link" itemprop="url">Docker容器内的信号处理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:41:33 / 修改时间：19:59:12" itemprop="dateCreated datePublished" datetime="2020-09-21T19:41:33+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Docker 关闭Container的思路：当我们使用docker stop 命令去关闭Container时，该命令会发送SIGTERM 命令到Container主进程，让主进程处理该信号，关闭Container，如果在10s内，未关闭容器，Docker Damon会发送SIGKILL 信号将Container关闭。</p>
<h2 id="Signal"><a href="#Signal" class="headerlink" title="       Signal"></a>       Signal</h2><p>Signal 表示内部进程的一种通信机制，一个信号表示一个从内核发送到进程的消息，该消息表示某个事件已经发生，当进程收到该信号，进程会被打断，一个信号处理句柄会处理该信号，如果没有针对该信号的句柄，会使用默认句柄处理该信号。</p>
<p>进程会将自己可以处理的信号以回调函数的方式注册到系统内核，当你在终端执行一个Kill命令时，实际上你是在通知内核向其他进程发送信号。一个常见的信号时 SIGTERM，该信号时通知进程关闭并终止，当进程收到该信号时，可以执行关闭Socket、数据库连接、删除临时文件等。许多守护进程会处理SIGHUP信号，从而能够重新加载配置文件，SIGUSR1和SIGUSR2是用户自定义的信号，可以在应用中处理该信号。</p>
<p> 举例,在Node.js中处理SIGTERM信号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">process.on(&#39;SIGTERM&#39;, function() &#123;</span><br><span class="line">  console.log(&#39;shutting down...&#39;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p>当进程处理SIGTERM信号时，处理该信号的句柄会将程序的执行打断，当该句柄执行完成后，程序才会继续运行，常见的信号如下表所示， 除了SIGKILL 和SIGSTOP信号外，其他信号都可以被进程终止</p>
<p> <img src="/2020/09/21/Docker%E5%AE%B9%E5%99%A8%E5%86%85%E7%9A%84%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/uploads/2016/06/20160630141912_66480.png"></p>
<h2 id="Docker中的信号"><a href="#Docker中的信号" class="headerlink" title="Docker中的信号"></a>Docker中的信号</h2><p>Docker命令“docker kill”向容器内的主进程发送信号</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Usage: docker kill \[OPTIONS\] CONTAINER \[CONTAINER...\]</span><br><span class="line">Kill a running container using SIGKILL or a specified signal</span><br><span class="line">    -s, --signal&#x3D;&quot;KILL&quot;    Signal to send to the container</span><br></pre></td></tr></table></figure>



<p>发送到容器的信号被容器的主进程（PID为1）处理，主进程可以忽略该信号，让默认的操作执行，或者为该信号提供一个回调函数。</p>
<p>举例，在容器内运行一个应用，检查信号处理句柄。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var http &#x3D; require(&#39;http&#39;);</span><br><span class="line">var server &#x3D; http.createServer(function (req, res) &#123;</span><br><span class="line">  res.writeHead(200, &#123;&#39;Content-Type&#39;: &#39;text&#x2F;plain&#39;&#125;);</span><br><span class="line">  res.end(&#39;Hello World\\n&#39;);</span><br><span class="line">&#125;).listen(3000, &#39;0.0.0.0&#39;);</span><br><span class="line">console.log(&#39;server started&#39;);</span><br><span class="line">var signals &#x3D; &#123; &#39;SIGINT&#39;: 2, &#39;SIGTERM&#39;: 15</span><br><span class="line">&#125;;</span><br><span class="line">function shutdown(signal, value) &#123; server.close(function () &#123; console.log(&#39;server stopped by &#39; + signal);</span><br><span class="line">    process.exit(128 + value);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">Object.keys(signals).forEach(function (signal) &#123;</span><br><span class="line">  process.on(signal, function () &#123; shutdown(signal, signals\[signal\]);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p> 我们创建了一个监听3000端口的http server，创建了两个信号处理句柄，分别处理SIGINT和SIGTERM信号，当信号句柄执行时，将会在标准输出打印：</p>
<p>   `server stopped by [SIGNAL]`.</p>
<p>分两种场景描述</p>
<h3 id="该应用是前端应用"><a href="#该应用是前端应用" class="headerlink" title="该应用是前端应用"></a>该应用是前端应用</h3><p>当应用是该容器的主进程时，他能够直接处理信号，以下该应用的Dockerfile文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FROM iojs:onbuild</span><br><span class="line">COPY .&#x2F;program.js .&#x2F;program.js</span><br><span class="line">COPY .&#x2F;package.json .&#x2F;package.json</span><br><span class="line">EXPOSE 3000</span><br><span class="line">ENTRYPOINT \[&quot;node&quot;, &quot;program&quot;\]</span><br></pre></td></tr></table></figure>



<p>当在编写Dockerfile文件的时候，启动应用一定要使用ENTRYPOINT或者RUN 命令，否则容器内的主进程将会是/bin/sh –c ，应用只能是主进程的子进程，如果是这样的话，应用是无法收到信号的。</p>
<p>构建镜像:</p>
<p>$ docker build -t signal-fg-app .</p>
<p>运行容器</p>
<p>$ docker run -it –rm -p 3000:3000 –name=”signal-fg-app” signal-fg-app</p>
<p>访问 <a target="_blank" rel="noopener" href="http://localhost:3000/">http://localhost:3000</a> 验证应用正常运行</p>
<p>打开另一个终端执行docker kill 命令</p>
<p>$ docker kill –signal=”SIGTERM” signal-fg-app</p>
<p>或者</p>
<p>$ docker stop signal-fg-app</p>
<p>这两个命令都可以发送SIGTERM信号来停止应用</p>
<p>Both commands can be used to issue SIGTERM signal and stop the application.</p>
<p>在运行应用的终端，可以看到下面的输出日志</p>
<p>server stopped by SIGTERM</p>
<h3 id="当应用是后台应用时"><a href="#当应用是后台应用时" class="headerlink" title="当应用是后台应用时"></a>当应用是后台应用时</h3><p>无法直接将信号发送到该应用，这种场景下的一种解决方法是：以shell脚本的方式启动应用，在这个启动脚本里处理全部的信号，制作该应用的Dokcerfile文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Dockerfile:</span><br><span class="line">FROM iojs:onbuild</span><br><span class="line">COPY .&#x2F;program.js .&#x2F;program.js</span><br><span class="line">COPY .&#x2F;program.sh .&#x2F;program.sh</span><br><span class="line">COPY .&#x2F;package.json .&#x2F;package.json</span><br><span class="line">RUN  chmod +x .&#x2F;program.sh</span><br><span class="line">EXPOSE 3000</span><br><span class="line">ENTRYPOINT \[&quot;.&#x2F;program.sh&quot;\]</span><br></pre></td></tr></table></figure>

<p>查看启动脚本program.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;env bash</span><br><span class="line">set -x</span><br><span class="line"></span><br><span class="line">pid&#x3D;0</span><br><span class="line"></span><br><span class="line"># SIGUSR1-handler</span><br><span class="line">my\_handler() &#123;</span><br><span class="line">  echo &quot;my\_handler&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># SIGTERM-handler</span><br><span class="line">term\_handler() &#123;</span><br><span class="line">  if \[ $pid -ne 0 \]; then</span><br><span class="line">    kill -SIGTERM &quot;$pid&quot;</span><br><span class="line">    wait &quot;$pid&quot;</span><br><span class="line">  fi</span><br><span class="line">  exit 143; # 128 + 15 -- SIGTERM</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># setup handlers</span><br><span class="line"># on callback, kill the last background process, which is \&#96;tail -f &#x2F;dev&#x2F;null\&#96; and execute the specified handler</span><br><span class="line">trap &#39;kill $&#123;!&#125;; my\_handler&#39; SIGUSR1</span><br><span class="line">trap &#39;kill $&#123;!&#125;; term\_handler&#39; SIGTERM</span><br><span class="line"></span><br><span class="line"># run application</span><br><span class="line">node program &amp;</span><br><span class="line">pid&#x3D;&quot;$!&quot;</span><br><span class="line"></span><br><span class="line"># wait indefinetely</span><br><span class="line">while true</span><br><span class="line">do</span><br><span class="line">  tail -f &#x2F;dev&#x2F;null &amp; wait $&#123;!&#125;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>这里我们创建了两个信号处理函数，一个是处理用户定义的信号，一个是处理SIGTEM信号，能够优雅的关闭应用。</p>
<p>在这个应用中，我们的应用是后台运行的（&amp;），最后，我们使用“wait”来暂停运行，直到一个子进程退出，“wait”和“waitpid”这两个函数在收到信号时，会终止执行，当收到信号后，我们使用特定的句柄处理信号。</p>
<p>  Docker的文档中说明，SIGCHLD, SIGKILL, and SIGSTOP 是无法代管的。</p>
<p>构建镜像：</p>
<p>docker build -t signal-bg-app .</p>
<p>运行容器:</p>
<p>docker run -it –rm -p 3000:3000 –name=”signal-bg-app” signal-bg-app</p>
<p>打开一个新的终端，发送 SIGUSR1 信号 :</p>
<p>docker kill –signal=”SIGUSR1” signal-bg-app</p>
<p>最后停止应用</p>
<p>docker kill –signal=”SIGTERM” signal-bg-app</p>
<p>应用能够打印相应的日志，并能够优雅的关闭</p>
<p>结论</p>
<p>信号提供了一中处理异步事件的方法，容器能运行的应用可以使用信号进行消息交互。使用信号与主机内的应用进行交互、重新加载配置文件、做一些清楚工作或者多进程协作。</p>
<p>英文地址：</p>
<p><a target="_blank" rel="noopener" href="https://medium.com/@gchudnov/trapping-signals-in-docker-containers-7a57fdda7d86#.ukb9dqt9k">https://medium.com/@gchudnov/trapping-signals-in-docker-containers-7a57fdda7d86#.ukb9dqt9k</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Docker%E6%8F%92%E4%BB%B6%E6%9C%BA%E5%88%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Docker%E6%8F%92%E4%BB%B6%E6%9C%BA%E5%88%B6/" class="post-title-link" itemprop="url">Docker插件机制</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:39:20 / 修改时间：19:59:12" itemprop="dateCreated datePublished" datetime="2020-09-21T19:39:20+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="Docker-插件是什么"><a href="#Docker-插件是什么" class="headerlink" title="Docker 插件是什么"></a>Docker 插件是什么</h2><p>docker 插件是 docker 提供出来的扩展机制，目前 docker 支持 volume 和 network 两种插件，由于 network 插件比较复杂而且没有好的开源项目，这里主要介绍 volume 插件。</p>
<p>插件是一个独立的进程和 docker daemon 运行在同一台 host 上，通过 Plugin Discovery 的机制进行插件发现，插件有几个要求：</p>
<ul>
<li>插件名要求是小写</li>
<li>插件可以运行在容器内也可以运行在容器外，不过现阶段建议运行在容器外</li>
</ul>
<h2 id="插件发现"><a href="#插件发现" class="headerlink" title="插件发现"></a>插件发现</h2><p>插件发现机制需要插件将自己的地址文件放在固定目录，方便 docker 发现插件进程，有三种文件可以设置：</p>
<ul>
<li>.sock 文件是 UNIX domain sockets</li>
<li>.spec 文本文件内包含了一个 URL，比如：unix:///other.sock</li>
<li>.json 文本文件包含了插件的完整 JSON 描述</li>
</ul>
<p>UNIX domain socket 文件必须放在 /run/docker/plugins 目录，但是 .spec，.json 文件则可以放在/etc/docker/plugins 或者 /usr/lib/docker/plugins 中。</p>
<p>无后缀的文件名决定了插件的名字，比如 /run/docker/plugins/myplugin.sock 的插件名就是myplugin。你可以在子目录中放置地址文件，比如 /run/docker/plugins/myplugin/myplugin.sock。</p>
<p>docker 优先搜索 /run/docker/plugins 目录，如果没有 unix socket 的话才会去搜索/etc/docker/plugins 和 /usr/lib/docker/plugins，如果根据指定插件名搜到了插件就会立马停止搜索。</p>
<h3 id="json"><a href="#json" class="headerlink" title=".json"></a>.json</h3><p>JSON 格式文件示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Name&quot;: &quot;plugin-example&quot;,  &quot;Addr&quot;: &quot;https:&#x2F;&#x2F;example.com&#x2F;docker&#x2F;plugin&quot;,  &quot;TLSConfig&quot;: &#123;  &quot;InsecureSkipVerify&quot;: false,  &quot;CAFile&quot;: &quot;&#x2F;usr&#x2F;shared&#x2F;docker&#x2F;certs&#x2F;example-ca.pem&quot;,  &quot;CertFile&quot;: &quot;&#x2F;usr&#x2F;shared&#x2F;docker&#x2F;certs&#x2F;example-cert.pem&quot;,  &quot;KeyFile&quot;: &quot;&#x2F;usr&#x2F;shared&#x2F;docker&#x2F;certs&#x2F;example-key.pem&quot;,  &#125; &#125; </span><br></pre></td></tr></table></figure>

<h2 id="插件生命周期"><a href="#插件生命周期" class="headerlink" title="插件生命周期"></a>插件生命周期</h2><ul>
<li>启动插件</li>
<li>启动 docker</li>
<li>停止 docker</li>
<li>停止插件</li>
</ul>
<h2 id="插件激活"><a href="#插件激活" class="headerlink" title="插件激活"></a>插件激活</h2><p>运行命令 docker run –volume-driver=foo 即可以激活名为 foo 的 volume 插件，需要注意的是，插件是按需加载机制，只有被使用到了才会被激活。</p>
<h2 id="volume-插件使用"><a href="#volume-插件使用" class="headerlink" title="volume 插件使用"></a>volume 插件使用</h2><p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -ti -v volumename:&#x2F;data \--volume-driver&#x3D;flocker busybox sh </span><br></pre></td></tr></table></figure>

<p>上面表示的意思是，使用 flocker 插件将 voluemname 挂载到容器的 /data 目录。</p>
<p>注意：volumename 一定不能以 / 开头。（文档说的，没看 docker 源码，我实现一个以 / 开头好像也没问题，应该是规范吧）</p>
<h2 id="插件-API-设计"><a href="#插件-API-设计" class="headerlink" title="插件 API 设计"></a>插件 API 设计</h2><p>插件是 API 是基于 HTTP 的 JSON POST 请求，所以插件需要实现一个 HTTP 服务器并且将其 bind 到一个 UNIX socket 上。API 的版本设置在了 HTTP<br>头里面，现在这个头的固定值为：application/vnd.docker.plugins.v1+json</p>
<p>不过 docker 的开发人员已经提供了一个比较好的 docker volume 的扩展 API 代码，可以参考：<a target="_blank" rel="noopener" href="https://github.com/calavera/dkvolume">docker-volume-extension-api</a></p>
<h3 id="Plugin-Activate"><a href="#Plugin-Activate" class="headerlink" title="/Plugin.Activate"></a>/Plugin.Activate</h3><p>请求：空</p>
<p>响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Implements:&quot; \[&quot;VolumeDriver&quot;\] &#125; </span><br></pre></td></tr></table></figure>

<p>返回插件实现，表示是 volume 插件</p>
<h3 id="VolumeDriver-Create"><a href="#VolumeDriver-Create" class="headerlink" title="/VolumeDriver.Create"></a>/VolumeDriver.Create</h3><p>请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Name&quot;: &quot;volume\_name&quot; &#125; </span><br></pre></td></tr></table></figure>

<p>告诉插件用户想要创建一个 volume，并将用户输入的 volume 名传给插件。插件在这个时候可以不用理会这个请求，会有真正挂载的请求。</p>
<p>响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Err&quot;: null &#125; </span><br></pre></td></tr></table></figure>

<p>如果出错返回错误字符串。</p>
<h3 id="VolumeDriver-Remove"><a href="#VolumeDriver-Remove" class="headerlink" title="/VolumeDriver.Remove"></a>/VolumeDriver.Remove</h3><p>与 Create 相对应。</p>
<p>请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Name&quot;: &quot;volume\_name&quot; &#125; </span><br></pre></td></tr></table></figure>

<p>响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Err&quot;: null &#125; </span><br></pre></td></tr></table></figure>

<h3 id="VolumeDriver-Mount"><a href="#VolumeDriver-Mount" class="headerlink" title="/VolumeDriver.Mount"></a>/VolumeDriver.Mount</h3><p>请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Name&quot;: &quot;volume\_name&quot; &#125; </span><br></pre></td></tr></table></figure>

<p>用户请求挂载某个文件，这个请求仅会在容器启动时发送一次。</p>
<p>响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Mountpoint&quot;: &quot;&#x2F;path&#x2F;to&#x2F;directory&#x2F;on&#x2F;host&quot;,  &quot;Err&quot;: null &#125; </span><br></pre></td></tr></table></figure>

<p>将 volume_name 挂载的真正挂载点返回给 docker，如果出错则返回错误字符串。</p>
<h3 id="VolumeDriver-Path"><a href="#VolumeDriver-Path" class="headerlink" title="/VolumeDriver.Path"></a>/VolumeDriver.Path</h3><p>请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Name&quot;: &quot;volume\_name&quot; &#125; </span><br></pre></td></tr></table></figure>

<p>响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Mountpoint&quot;: &quot;&#x2F;path&#x2F;to&#x2F;directory&#x2F;on&#x2F;host&quot;,  &quot;Err&quot;: null &#125; </span><br></pre></td></tr></table></figure>

<p>插件需要管理 volume_name 的真正挂载地址，这个请求需要将 volume_name 挂载的真正挂载点返回给 docker，如果出错则返回错误字符串。</p>
<h3 id="VolumeDriver-Unmount"><a href="#VolumeDriver-Unmount" class="headerlink" title="/VolumeDriver.Unmount"></a>/VolumeDriver.Unmount</h3><p>请求：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;  &quot;Name&quot;: &quot;volume\_name&quot; &#125; </span><br></pre></td></tr></table></figure>

<p>表示 docker 已经不需要这个 volume 了，插件需要安全的将这个挂载从挂载点卸载。</p>
<p>响应：</p>
<pre><code>&#123;  &quot;Err&quot;: null &#125;</code></pre>
<p>（<a target="_blank" rel="noopener" href="http://hongweiyi.com/2015/10/docker-volume-plugin/%EF%BC%89">http://hongweiyi.com/2015/10/docker-volume-plugin/）</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Docker%E7%B2%BE%E7%AE%80%E9%95%9C%E5%83%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Docker%E7%B2%BE%E7%AE%80%E9%95%9C%E5%83%8F/" class="post-title-link" itemprop="url">Docker精简镜像</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:34:25 / 修改时间：19:59:12" itemprop="dateCreated datePublished" datetime="2020-09-21T19:34:25+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="精简Docker镜像大小的必要性"><a href="#精简Docker镜像大小的必要性" class="headerlink" title="精简Docker镜像大小的必要性"></a>精简Docker镜像大小的必要性</h3><p>Docker镜像由很多镜像层（Layers）组成（最多127层），镜像层依赖于一系列的底层技术，比如文件系统(filesystems)、写时复制(copy-on-write)、联合挂载(union mounts)等技术，你可以查看Docker社区文档以了解更多有关Docker存储驱动的内容，这里就不再赘述技术细节。总的来说，Dockerfile中的每条指令都会创建一个镜像层，继而会增加整体镜像的尺寸。 下面是精简Docker镜像尺寸的好处： 1. 减少构建时间 2. 减少磁盘使用量 3. 减少下载时间 4. 因为包含文件少，攻击面减小，提高了安全性 5. 提高部署速度</p>
<h3 id="五点建议减小Docker镜像尺寸"><a href="#五点建议减小Docker镜像尺寸" class="headerlink" title="五点建议减小Docker镜像尺寸"></a>五点建议减小Docker镜像尺寸</h3><h3 id="优化基础镜像"><a href="#优化基础镜像" class="headerlink" title="优化基础镜像"></a>优化基础镜像</h3><p>优化基础镜像的方法就是选用合适的更小的基础镜像，常用的 Linux 系统镜像一般有 Ubuntu、CentOs、Alpine，其中Alpine更推荐使用。大小对比如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">lynzabo@ubuntu ~&#x2F;s&gt; docker images</span><br><span class="line">REPOSITORY         TAG             IMAGE ID            CREATED             SIZE</span><br><span class="line">ubuntu             latest        74f8760a2a8b        8 days ago          82.4MB</span><br><span class="line">alpine             latest        11cd0b38bc3c        2 weeks ago         4.41MB</span><br><span class="line">centos               7           49f7960eb7e4        7 weeks ago         200MB</span><br><span class="line">debian             latest        3bbb526d2608        8 days ago          101MB</span><br><span class="line">lynzabo@ubuntu ~&#x2F;s&gt; </span><br></pre></td></tr></table></figure>
<p>Alpine是一个高度精简又包含了基本工具的轻量级Linux发行版，基础镜像只有4.41M，各开发语言和框架都有基于Alpine制作的基础镜像，强烈推荐使用它。Alpine镜像各个语言和框架支持情况，可以参考《优化Docker镜像、加速应用部署，教你6个小窍门》。 查看上面的镜像尺寸对比结果，你会发现最小的镜像也有4.41M，那么有办法构建更小的镜像吗？答案是肯定的，例如 gcr.io/google_containers/pause-amd64:3.1 镜像仅有742KB。为什么这个镜像能这么小？在为大家解密之前，再推荐两个基础镜像： 1、scratch镜像 scratch是一个空镜像，只能用于构建其他镜像，比如你要运行一个包含所有依赖的二进制文件，如Golang程序，可以直接使用scratch作为基础镜像。现在给大家展示一下上文提到的Google pause镜像Dockerfile：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM scratch</span><br><span class="line">ARG ARCH</span><br><span class="line">ADD bin&#x2F;pause-$&#123;ARCH&#125; &#x2F;pause</span><br><span class="line">ENTRYPOINT [&quot;&#x2F;pause&quot;] </span><br></pre></td></tr></table></figure>
<p>Google pause镜像使用了scratch作为基础镜像，这个镜像本身是不占空间的，使用它构建的镜像大小几乎和二进制文件本身一样大，所以镜像非常小。当然在我们的Golang程序中也会使用。对于一些Golang/C程序，可能会依赖一些动态库，你可以使用自动提取动态库工具，比如ldd、linuxdeployqt等提取所有动态库，然后将二进制文件和依赖动态库一起打包到镜像中。 2、busybox镜像 scratch是个空镜像，如果希望镜像里可以包含一些常用的Linux工具，busybox镜像是个不错选择，镜像本身只有1.16M，非常便于构建小镜像。</p>
<h4 id="串联-Dockerfile-指令"><a href="#串联-Dockerfile-指令" class="headerlink" title="串联 Dockerfile 指令"></a>串联 Dockerfile 指令</h4><p>大家在定义Dockerfile时，如果太多的使用RUN指令，经常会导致镜像有特别多的层，镜像很臃肿，而且甚至会碰到超出最大层数（127层）限制的问题，遵循 Dockerfile 最佳实践，我们应该把多个命令串联合并为一个 RUN（通过运算符&amp;&amp;和/ 来实现），每一个 RUN 要精心设计，确保安装构建最后进行清理，这样才可以降低镜像体积，以及最大化的利用构建缓存。 下面是一个优化前Dockerfile：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu</span><br><span class="line"></span><br><span class="line">ENV VER     3.0.0  </span><br><span class="line">ENV TARBALL http:&#x2F;&#x2F;download.redis.io&#x2F;releases&#x2F;redis-$VER.tar.gz  </span><br><span class="line"># &#x3D;&#x3D;&gt; Install curl and helper tools...</span><br><span class="line">RUN apt-get update  </span><br><span class="line">RUN apt-get install -y  curl make gcc  </span><br><span class="line"># &#x3D;&#x3D;&gt; Download, compile, and install...</span><br><span class="line">RUN curl -L $TARBALL | tar zxv  </span><br><span class="line">WORKDIR  redis-$VER  </span><br><span class="line">RUN make  </span><br><span class="line">RUN make install  </span><br><span class="line">#...</span><br><span class="line"># &#x3D;&#x3D;&gt; Clean up...</span><br><span class="line">WORKDIR &#x2F;  </span><br><span class="line">RUN apt-get remove -y --auto-remove curl make gcc  </span><br><span class="line">RUN apt-get clean  </span><br><span class="line">RUN rm -rf &#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;*  &#x2F;redis-$VER  </span><br><span class="line">#...</span><br><span class="line">CMD [&quot;redis-server&quot;] </span><br></pre></td></tr></table></figure>
<p>构建镜像，名称叫 test/test:0.1。 我们对Dockerfile做优化，优化后Dockerfile：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu</span><br><span class="line"></span><br><span class="line">ENV VER     3.0.0  </span><br><span class="line">ENV TARBALL http:&#x2F;&#x2F;download.redis.io&#x2F;releases&#x2F;redis-$VER.tar.gz</span><br><span class="line"></span><br><span class="line">RUN echo &quot;&#x3D;&#x3D;&gt; Install curl and helper tools...&quot;  &amp;&amp; \  </span><br><span class="line">    apt-get update                      &amp;&amp; \</span><br><span class="line">    apt-get install -y  curl make gcc   &amp;&amp; \</span><br><span class="line">    echo &quot;&#x3D;&#x3D;&gt; Download, compile, and install...&quot;  &amp;&amp; \</span><br><span class="line">    curl -L $TARBALL | tar zxv  &amp;&amp; \</span><br><span class="line">    cd redis-$VER               &amp;&amp; \</span><br><span class="line">    make                        &amp;&amp; \</span><br><span class="line">    make install                &amp;&amp; \</span><br><span class="line">    echo &quot;&#x3D;&#x3D;&gt; Clean up...&quot;  &amp;&amp; \</span><br><span class="line">    apt-get remove -y --auto-remove curl make gcc  &amp;&amp; \</span><br><span class="line">    apt-get clean                                  &amp;&amp; \</span><br><span class="line">    rm -rf &#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;*  &#x2F;redis-$VER</span><br><span class="line">#...</span><br><span class="line">CMD [&quot;redis-server&quot;] </span><br></pre></td></tr></table></figure>
<p>构建镜像，名称叫 test/test:0.2。 对比两个镜像大小：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@k8s-master:&#x2F;tmp&#x2F;iops# docker images</span><br><span class="line">REPOSITORY       TAG           IMAGE ID            CREATED             SIZE</span><br><span class="line">test&#x2F;test        0.2         58468c0222ed        2 minutes ago       98.1MB</span><br><span class="line">test&#x2F;test        0.1         e496cf7243f2        6 minutes ago       307MB</span><br><span class="line">root@k8s-master:&#x2F;tmp&#x2F;iops# </span><br></pre></td></tr></table></figure>
<p>可以看到，将多条RUN命令串联起来构建的镜像大小是每条命令分别RUN的三分之一。 提示：为了应对镜像中存在太多镜像层，Docker 1.13版本以后，提供了一个压扁镜像功能，即将 Dockerfile 中所有的操作压缩为一层。这个特性还处于实验阶段，Docker默认没有开启，如果要开启，需要在启动Docker时添加-experimental 选项，并在Docker build 构建镜像时候添加 –squash 。我们不推荐使用这个办法，请在撰写 Dockerfile 时遵循最佳实践编写，不要试图用这种办法去压缩镜像。</p>
<h4 id="使用多阶段构建"><a href="#使用多阶段构建" class="headerlink" title="使用多阶段构建"></a>使用多阶段构建</h4><p>Dockerfile中每条指令都会为镜像增加一个镜像层，并且你需要在移动到下一个镜像层之前清理不需要的组件。实际上，有一个Dockerfile用于开发（其中包含构建应用程序所需的所有内容）以及一个用于生产的瘦客户端，它只包含你的应用程序以及运行它所需的内容。这被称为“建造者模式”。Docker 17.05.0-ce版本以后支持多阶段构建。使用多阶段构建，你可以在Dockerfile中使用多个FROM语句，每条FROM指令可以使用不同的基础镜像，这样您可以选择性地将服务组件从一个阶段COPY到另一个阶段，在最终镜像中只保留需要的内容。 下面是一个使用COPY –from 和 FROM … AS … 的Dockerfile：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># Compile</span><br><span class="line">FROM golang:1.9.0 AS builder</span><br><span class="line">WORKDIR &#x2F;go&#x2F;src&#x2F;v9.git...com&#x2F;...&#x2F;k8s-monitor</span><br><span class="line">COPY . .</span><br><span class="line">WORKDIR &#x2F;go&#x2F;src&#x2F;v9.git...com&#x2F;...&#x2F;k8s-monitor</span><br><span class="line">RUN make build</span><br><span class="line">RUN mv k8s-monitor &#x2F;root</span><br><span class="line"></span><br><span class="line"># Package</span><br><span class="line"># Use scratch image</span><br><span class="line">FROM scratch</span><br><span class="line">WORKDIR &#x2F;root&#x2F;</span><br><span class="line">COPY --from&#x3D;builder &#x2F;root .</span><br><span class="line">EXPOSE 8080</span><br><span class="line">CMD [&quot;&#x2F;root&#x2F;k8s-monitor&quot;] </span><br></pre></td></tr></table></figure>
<p>构建镜像，你会发现生成的镜像只有上面COPY 指令指定的内容，镜像大小只有2M。这样在以前使用两个Dockerfile（一个Dockerfile用于开发和一个用于生产的瘦客户端），现在使用多阶段构建就可以搞定。</p>
<h4 id="业务服务镜像技巧"><a href="#业务服务镜像技巧" class="headerlink" title="业务服务镜像技巧"></a>业务服务镜像技巧</h4><p>Docker在build镜像的时候，如果某个命令相关的内容没有变化，会使用上一次缓存（cache）的文件层，在构建业务镜像的时候可以注意下面两点： 不变或者变化很少的体积较大的依赖库和经常修改的自有代码分开； 因为cache缓存在运行Docker build命令的本地机器上，建议固定使用某台机器来进行Docker build，以便利用cache。 下面是构建Spring Boot应用镜像的例子，用来说明如何分层。其他类型的应用，比如Java WAR包，Nodejs的npm 模块等，可以采取类似的方式。 1、在Dockerfile所在目录，解压缩maven生成的jar包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ unzip &lt;path-to-app-jar&gt;.jar -d app </span><br></pre></td></tr></table></figure>
<p>2、Dockerfile 我们把应用的内容分成4个部分COPY到镜像里面：其中前面3个基本不变，第4个是经常变化的自有代码。最后一行是解压缩后，启动spring boot应用的方式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FROM openjdk:8-jre-alpine</span><br><span class="line"></span><br><span class="line">LABEL maintainer &quot;opl-xws@xiaomi.com&quot;</span><br><span class="line">COPY app&#x2F;BOOT-INF&#x2F;lib&#x2F; &#x2F;app&#x2F;BOOT-INF&#x2F;lib&#x2F;</span><br><span class="line">COPY app&#x2F;org &#x2F;app&#x2F;org</span><br><span class="line">COPY app&#x2F;META-INF &#x2F;app&#x2F;META-INF</span><br><span class="line">COPY app&#x2F;BOOT-INF&#x2F;classes &#x2F;app&#x2F;BOOT-INF&#x2F;classes</span><br><span class="line">EXPOSE 8080</span><br><span class="line">CMD [&quot;&#x2F;usr&#x2F;bin&#x2F;java&quot;, &quot;-cp&quot;, &quot;&#x2F;app&quot;, &quot;org.springframework.boot.loader.JarLauncher&quot;] </span><br></pre></td></tr></table></figure>
<p>这样在构建镜像时候可大大提高构建速度。 ###其他优化方法 1. RUN命令中执行apt、apk或者yum类工具技巧 如果在RUN命令中执行apt、apk或者yum类工具，可以借助这些工具提供的一些小技巧来减少镜像层数量及镜像大小。举几个例子： （1）在执行apt-get install -y 时增加选项— no-install-recommends ，可以不用安装建议性（非必须）的依赖，也可以在执行apk add 时添加选项–no-cache 达到同样效果； （2）执行yum install -y 时候， 可以同时安装多个工具，比如yum install -y gcc gcc-c++ make …。将所有yum install 任务放在一条RUN命令上执行，从而减少镜像层的数量； （3）组件的安装和清理要串联在一条指令里面，如 apk –update add php7 &amp;&amp; rm -rf /var/cache/apk/* ，因为Dockerfile的每条指令都会产生一个文件层，如果将apk add … 和 rm -rf … 命令分开，清理无法减小apk命令产生的文件层的大小。 Ubuntu或Debian可以使用 rm -rf /<strong>var</strong>/lib/apt/lists/* 清理镜像中缓存文件；CentOS等系统使用yum clean all 命令清理。 2. 压缩镜像 Docker 自带的一些命令还能协助压缩镜像，比如 export 和 import</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d test&#x2F;test:0.2</span><br><span class="line">$ docker export 747dc0e72d13 | docker import - test&#x2F;test:0.3 </span><br></pre></td></tr></table></figure>
<p>使用这种方式需要先将容器运行起来，而且这个过程中会丢失镜像原有的一些信息，比如：导出端口，环境变量，默认指令。 查看这两个镜像history信息，如下，可以看到test/test:0.3 丢失了所有的镜像层信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">root@k8s-master:&#x2F;tmp&#x2F;iops# docker history test&#x2F;test:0.3</span><br><span class="line">IMAGE               CREATED             CREATED BY          SIZE                COMMENT</span><br><span class="line">6fb3f00b7a72        15 seconds ago                          84.7MB              Imported from -</span><br><span class="line">root@k8s-master:&#x2F;tmp&#x2F;iops# docker history test&#x2F;test:0.2</span><br><span class="line">IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT</span><br><span class="line">58468c0222ed        2 hours ago         &#x2F;bin&#x2F;sh -c #(nop)  CMD [&quot;redis-server&quot;]         0B       </span><br><span class="line">1af7ffe3d163        2 hours ago         &#x2F;bin&#x2F;sh -c echo &quot;&#x3D;&#x3D;&gt; Install curl and helper…   15.7MB   </span><br><span class="line">8bac6e733d54        2 hours ago         &#x2F;bin&#x2F;sh -c #(nop)  ENV TARBALL&#x3D;http:&#x2F;&#x2F;downlo…   0B       </span><br><span class="line">793282f3ef7a        2 hours ago         &#x2F;bin&#x2F;sh -c #(nop)  ENV VER&#x3D;3.0.0                0B       </span><br><span class="line">74f8760a2a8b        8 days ago          &#x2F;bin&#x2F;sh -c #(nop)  CMD [&quot;&#x2F;bin&#x2F;bash&quot;]            0B       </span><br><span class="line">&lt;missing&gt;           8 days ago          &#x2F;bin&#x2F;sh -c mkdir -p &#x2F;run&#x2F;systemd &amp;&amp; echo &#39;do…   7B</span><br><span class="line">&lt;missing&gt;           8 days ago          &#x2F;bin&#x2F;sh -c sed -i &#39;s&#x2F;^#\s*\(deb.*universe\)$…   2.76kB</span><br><span class="line">&lt;missing&gt;           8 days ago          &#x2F;bin&#x2F;sh -c rm -rf &#x2F;var&#x2F;lib&#x2F;apt&#x2F;lists&#x2F;*          0B</span><br><span class="line">&lt;missing&gt;           8 days ago          &#x2F;bin&#x2F;sh -c set -xe   &amp;&amp; echo &#39;#!&#x2F;bin&#x2F;sh&#39; &gt; &#x2F;…   745B    </span><br><span class="line">&lt;missing&gt;           8 days ago          &#x2F;bin&#x2F;sh -c #(nop) ADD file:5fabb77ea8d61e02d…   82.4MB   </span><br><span class="line">root@k8s-master:&#x2F;tmp&#x2F;iops# </span><br></pre></td></tr></table></figure>
<p>社区里还有很多压缩工具，比如Docker-squash ，用起来更简单方便，并且不会丢失原有镜像的自带信息，大家有兴趣可以试试。 转自<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/blZt_jmHBprX9tzbyQRWIg">米生态云</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Docker%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%E5%88%A0%E9%99%A4%E5%8E%86%E5%8F%B2%E7%89%88%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Docker%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%E5%88%A0%E9%99%A4%E5%8E%86%E5%8F%B2%E7%89%88%E6%9C%AC/" class="post-title-link" itemprop="url">Docker镜像仓库删除历史版本</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:32:40 / 修改时间：19:59:12" itemprop="dateCreated datePublished" datetime="2020-09-21T19:32:40+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>DevOps环境使用的镜像仓库，一个产品的版本越来越多，需要能够定时将不再使用的历史版本进行删除，编写乐意一段代码，用于删除历史版本的镜像，如下所示```</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">import argparse</span><br><span class="line">import http.client</span><br><span class="line">import urllib.error</span><br><span class="line">import urllib.request</span><br><span class="line">import json</span><br><span class="line">import urllib3</span><br><span class="line">import requests</span><br><span class="line">REGISTRY_URL&#x3D;&quot;http:&#x2F;&#x2F;10.10.70.65&quot;</span><br><span class="line">MOST_TAG_NUMBER&#x3D;3</span><br><span class="line">def getAllRepos(registry_repo_url):</span><br><span class="line">    try:</span><br><span class="line">        resp &#x3D; urllib.request.urlopen(registry_repo_url) # type http.client.HTTPResponse</span><br><span class="line">        response &#x3D; resp.read()</span><br><span class="line">    except urllib.error.HTTPError as error:</span><br><span class="line">        print(&quot;get repo error&quot;,error)</span><br><span class="line">    return json.loads(response)</span><br><span class="line"></span><br><span class="line">def getImageDigest(repoName,tagName):</span><br><span class="line">    #http: &#x2F;&#x2F; 10.10.70.65 &#x2F; v2 &#x2F; arch &#x2F; archdemo &#x2F; manifests &#x2F; 1 - 1881</span><br><span class="line"></span><br><span class="line">    #curl -H &quot;Accept: application&#x2F;vnd.docker.distribution.manifest.v2 + json&quot; -X GET -vvv -k http:&#x2F;&#x2F;10.10.70.65&#x2F;v2&#x2F;good_image&#x2F;manifests&#x2F;latest 100</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        req &#x3D; urllib.request.Request(REGISTRY_URL + &quot;&#x2F;v2&#x2F;&quot; + repoName + &quot;&#x2F;manifests&#x2F;&quot;+tagName)</span><br><span class="line">        req.add_header(&#39;Accept&#39;, &#39;application&#x2F;vnd.docker.distribution.manifest.v2+json&#39;)</span><br><span class="line">        resp &#x3D; urllib.request.urlopen(req)</span><br><span class="line">      #  content &#x3D; resp.read()</span><br><span class="line">       # print(&quot;all is&quot;, resp)</span><br><span class="line"></span><br><span class="line">        #print(&quot;content is &quot;,content)</span><br><span class="line">        #print(&quot;digest is&quot;,resp.headers[&quot;Docker-Content-Digest&quot;])</span><br><span class="line">    except urllib.error.HTTPError as error:</span><br><span class="line">        print(&quot;get repo error&quot;,error)</span><br><span class="line">    return resp.headers[&quot;Docker-Content-Digest&quot;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def deleteTagByTag(repoName, tagName):</span><br><span class="line">    imageDigest&#x3D;getImageDigest(repoName, tagName)</span><br><span class="line">    try:</span><br><span class="line">        print(&quot;delete image %s:%s,digest is %s&quot; %(repoName,tagName,imageDigest))</span><br><span class="line">        req &#x3D; urllib.request.Request(REGISTRY_URL + &quot;&#x2F;v2&#x2F;&quot; + repoName + &quot;&#x2F;manifests&#x2F;&quot;+imageDigest)</span><br><span class="line">        req.get_method &#x3D; lambda: &#39;DELETE&#39;</span><br><span class="line">        resp &#x3D; urllib.request.urlopen(req)</span><br><span class="line">        code &#x3D; resp.getcode()</span><br><span class="line">        print(&quot;delet image code is &quot;,code)</span><br><span class="line">    except urllib.error.HTTPError as error:</span><br><span class="line">        print(&quot;delete image error&quot;,error)</span><br><span class="line"></span><br><span class="line">def cleanByRepo(repoName):</span><br><span class="line">    print(&quot;repos is &quot; + repoName)</span><br><span class="line">    tagList &#x3D; getTagsByRepoNames(REGISTRY_URL + &quot;&#x2F;v2&#x2F;&quot; + repoName + &quot;&#x2F;tags&#x2F;list&quot;)# type</span><br><span class="line">    print(&quot;tagList is &quot;, tagList)</span><br><span class="line">    if tagList[&quot;tags&quot;] is None:</span><br><span class="line">       print(&quot;repo not need to clean,tag is None&quot;, repoName)</span><br><span class="line">       return</span><br><span class="line">    if len(tagList[&quot;tags&quot;])&lt;2:</span><br><span class="line">        print(&quot;repo not need to clean&quot;,repoName)</span><br><span class="line">        return</span><br><span class="line">    tagNum&#x3D;0</span><br><span class="line">    tagNameList&#x3D;[]</span><br><span class="line">    for tag in tagList[&quot;tags&quot;]:</span><br><span class="line">        if tag.startswith(&quot;1-&quot;):</span><br><span class="line">            tagNum&#x3D;tagNum+1</span><br><span class="line">            tagNameList.append(tag)</span><br><span class="line"></span><br><span class="line">    if tagNum&lt;MOST_TAG_NUMBER:</span><br><span class="line">        print(&quot;repo %s not need to clean,tag num %s  is less than 4&quot;   % (repoName,tagNum))</span><br><span class="line">        return</span><br><span class="line"></span><br><span class="line">    #print(&quot;repo  %s need to delete some tag,tag num is %s&quot;, % (repoName,tagNum))</span><br><span class="line">    print(&quot;repo  %s need to delete some tag,tag num is %s  &quot; % (repoName,tagNum))</span><br><span class="line">    tagNameList.sort(reverse&#x3D;True)</span><br><span class="line">    for index, _ in enumerate(tagNameList):</span><br><span class="line">        if index&gt;3:</span><br><span class="line">            deleteTagByTag(repoName,tagNameList[index])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def getTagsByRepoNames(registry_repo_url):</span><br><span class="line">    try:</span><br><span class="line">        resp &#x3D; urllib.request.urlopen(registry_repo_url)</span><br><span class="line">        response &#x3D; resp.read()</span><br><span class="line">    except urllib.error.HTTPError as error:</span><br><span class="line">        print(&quot;get repo error&quot;,error)</span><br><span class="line">    return json.loads(response)</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    print(&quot;get all repo&quot;)</span><br><span class="line">    response&#x3D;getAllRepos(REGISTRY_URL + &quot;&#x2F;v2&#x2F;_catalog?n&#x3D;100000&quot;)</span><br><span class="line">    print(&quot;response is &quot;,response)</span><br><span class="line">    print(&quot;repos list is&quot;,response[&quot;repositories&quot;])</span><br><span class="line"></span><br><span class="line">    for repo in response[&quot;repositories&quot;]:</span><br><span class="line">        cleanByRepo(repo)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    main() </span><br></pre></td></tr></table></figure>
<p>上面的代码能保存最新的几个版本的镜像，我这里的版本镜像是以“1-” 开头为标识，执行完该代码后，还需要在镜像仓库的节点，执行以下命令，进行存储回收：```</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">registry garbage-collect &#x2F;etc&#x2F;docker&#x2F;registry&#x2F;config.yml </span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Docker-%E9%BB%98%E8%AE%A4%E7%9A%84Container%E5%90%8D%E7%A7%B0%E7%94%9F%E6%88%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Docker-%E9%BB%98%E8%AE%A4%E7%9A%84Container%E5%90%8D%E7%A7%B0%E7%94%9F%E6%88%90/" class="post-title-link" itemprop="url">Docker 默认的Container名称生成</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:31:04 / 修改时间：19:59:12" itemprop="dateCreated datePublished" datetime="2020-09-21T19:31:04+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>34k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>31 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>        当基于Docker创建Container时，如果不指定容器名称，Docker Damon会默认生成容器名称，这个名称看着是个真实的名称，找了一下docker的代码，发现了生成名称的机制，代码文件：<a target="_blank" rel="noopener" href="https://github.com/docker/docker">docker</a>/<a target="_blank" rel="noopener" href="https://github.com/docker/docker/tree/master/pkg">pkg</a>/<a target="_blank" rel="noopener" href="https://github.com/docker/docker/tree/master/pkg/namesgenerator">namesgenerator</a>/names-generator.go。查看代码，发现这些名称都是一些名人的名称，我只想说一句，docker 好任性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br></pre></td><td class="code"><pre><span class="line">package namesgenerator</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line"></span><br><span class="line">	&quot;github.com&#x2F;docker&#x2F;docker&#x2F;pkg&#x2F;random&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">var (</span><br><span class="line">	left &#x3D; \[...\]string&#123;</span><br><span class="line">		&quot;admiring&quot;,</span><br><span class="line">		&quot;adoring&quot;,</span><br><span class="line">		&quot;agitated&quot;,</span><br><span class="line">		&quot;amazing&quot;,</span><br><span class="line">		&quot;angry&quot;,</span><br><span class="line">		&quot;awesome&quot;,</span><br><span class="line">		&quot;backstabbing&quot;,</span><br><span class="line">		&quot;berserk&quot;,</span><br><span class="line">		&quot;big&quot;,</span><br><span class="line">		&quot;boring&quot;,</span><br><span class="line">		&quot;clever&quot;,</span><br><span class="line">		&quot;cocky&quot;,</span><br><span class="line">		&quot;compassionate&quot;,</span><br><span class="line">		&quot;condescending&quot;,</span><br><span class="line">		&quot;cranky&quot;,</span><br><span class="line">		&quot;desperate&quot;,</span><br><span class="line">		&quot;determined&quot;,</span><br><span class="line">		&quot;distracted&quot;,</span><br><span class="line">		&quot;dreamy&quot;,</span><br><span class="line">		&quot;drunk&quot;,</span><br><span class="line">		&quot;ecstatic&quot;,</span><br><span class="line">		&quot;elated&quot;,</span><br><span class="line">		&quot;elegant&quot;,</span><br><span class="line">		&quot;evil&quot;,</span><br><span class="line">		&quot;fervent&quot;,</span><br><span class="line">		&quot;focused&quot;,</span><br><span class="line">		&quot;furious&quot;,</span><br><span class="line">		&quot;gigantic&quot;,</span><br><span class="line">		&quot;gloomy&quot;,</span><br><span class="line">		&quot;goofy&quot;,</span><br><span class="line">		&quot;grave&quot;,</span><br><span class="line">		&quot;happy&quot;,</span><br><span class="line">		&quot;high&quot;,</span><br><span class="line">		&quot;hopeful&quot;,</span><br><span class="line">		&quot;hungry&quot;,</span><br><span class="line">		&quot;infallible&quot;,</span><br><span class="line">		&quot;jolly&quot;,</span><br><span class="line">		&quot;jovial&quot;,</span><br><span class="line">		&quot;kickass&quot;,</span><br><span class="line">		&quot;lonely&quot;,</span><br><span class="line">		&quot;loving&quot;,</span><br><span class="line">		&quot;mad&quot;,</span><br><span class="line">		&quot;modest&quot;,</span><br><span class="line">		&quot;naughty&quot;,</span><br><span class="line">		&quot;nauseous&quot;,</span><br><span class="line">		&quot;nostalgic&quot;,</span><br><span class="line">		&quot;peaceful&quot;,</span><br><span class="line">		&quot;pedantic&quot;,</span><br><span class="line">		&quot;pensive&quot;,</span><br><span class="line">		&quot;prickly&quot;,</span><br><span class="line">		&quot;reverent&quot;,</span><br><span class="line">		&quot;romantic&quot;,</span><br><span class="line">		&quot;sad&quot;,</span><br><span class="line">		&quot;serene&quot;,</span><br><span class="line">		&quot;sharp&quot;,</span><br><span class="line">		&quot;sick&quot;,</span><br><span class="line">		&quot;silly&quot;,</span><br><span class="line">		&quot;sleepy&quot;,</span><br><span class="line">		&quot;small&quot;,</span><br><span class="line">		&quot;stoic&quot;,</span><br><span class="line">		&quot;stupefied&quot;,</span><br><span class="line">		&quot;suspicious&quot;,</span><br><span class="line">		&quot;tender&quot;,</span><br><span class="line">		&quot;thirsty&quot;,</span><br><span class="line">		&quot;tiny&quot;,</span><br><span class="line">		&quot;trusting&quot;,</span><br><span class="line">		&quot;zen&quot;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	&#x2F;&#x2F; Docker, starting from 0.7.x, generates names from notable scientists and hackers.</span><br><span class="line">	&#x2F;&#x2F; Please, for any amazing man that you add to the list, consider adding an equally amazing woman to it, and vice versa.</span><br><span class="line">	right &#x3D; \[...\]string&#123;</span><br><span class="line">		&#x2F;&#x2F; Muhammad ibn Jābir al-Ḥarrānī al-Battānī was a founding father of astronomy. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Mu%E1%B8%A5ammad\_ibn\_J%C4%81bir\_al-%E1%B8%A4arr%C4%81n%C4%AB\_al-Batt%C4%81n%C4%AB</span><br><span class="line">		&quot;albattani&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Frances E. Allen, became the first female IBM Fellow in 1989. In 2006, she became the first female recipient of the ACM&#39;s Turing Award. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Frances\_E.\_Allen</span><br><span class="line">		&quot;allen&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; June Almeida - Scottish virologist who took the first pictures of the rubella virus - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;June\_Almeida</span><br><span class="line">		&quot;almeida&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Maria Gaetana Agnesi - Italian mathematician, philosopher, theologian and humanitarian. She was the first woman to write a mathematics handbook and the first woman appointed as a Mathematics Professor at a University. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Maria\_Gaetana\_Agnesi</span><br><span class="line">		&quot;agnesi&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Archimedes was a physicist, engineer and mathematician who invented too many things to list them here. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Archimedes</span><br><span class="line">		&quot;archimedes&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Maria Ardinghelli - Italian translator, mathematician and physicist - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Maria\_Ardinghelli</span><br><span class="line">		&quot;ardinghelli&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Aryabhata - Ancient Indian mathematician-astronomer during 476-550 CE https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Aryabhata</span><br><span class="line">		&quot;aryabhata&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Wanda Austin - Wanda Austin is the President and CEO of The Aerospace Corporation, a leading architect for the US security space programs. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Wanda\_Austin</span><br><span class="line">		&quot;austin&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Charles Babbage invented the concept of a programmable computer. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Charles\_Babbage.</span><br><span class="line">		&quot;babbage&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Stefan Banach - Polish mathematician, was one of the founders of modern functional analysis. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Stefan\_Banach</span><br><span class="line">		&quot;banach&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; John Bardeen co-invented the transistor - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;John\_Bardeen</span><br><span class="line">		&quot;bardeen&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Jean Bartik, born Betty Jean Jennings, was one of the original programmers for the ENIAC computer. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Jean\_Bartik</span><br><span class="line">		&quot;bartik&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Laura Bassi, the world&#39;s first female professor https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Laura\_Bassi</span><br><span class="line">		&quot;bassi&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Alexander Graham Bell - an eminent Scottish-born scientist, inventor, engineer and innovator who is credited with inventing the first practical telephone - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Alexander\_Graham\_Bell</span><br><span class="line">		&quot;bell&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Homi J Bhabha - was an Indian nuclear physicist, founding director, and professor of physics at the Tata Institute of Fundamental Research. Colloquially known as &quot;father of Indian nuclear programme&quot;- https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Homi\_J.\_Bhabha</span><br><span class="line">		&quot;bhabha&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Bhaskara II - Ancient Indian mathematician-astronomer whose work on calculus predates Newton and Leibniz by over half a millennium - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Bh%C4%81skara\_II#Calculus</span><br><span class="line">		&quot;bhaskara&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Elizabeth Blackwell - American doctor and first American woman to receive a medical degree - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Elizabeth\_Blackwell</span><br><span class="line">		&quot;blackwell&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Niels Bohr is the father of quantum theory. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Niels\_Bohr.</span><br><span class="line">		&quot;bohr&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Kathleen Booth, she&#39;s credited with writing the first assembly language. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Kathleen\_Booth</span><br><span class="line">		&quot;booth&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Anita Borg - Anita Borg was the founding director of the Institute for Women and Technology (IWT). https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Anita\_Borg</span><br><span class="line">		&quot;borg&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Satyendra Nath Bose - He provided the foundation for Bose–Einstein statistics and the theory of the Bose–Einstein condensate. - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Satyendra\_Nath\_Bose</span><br><span class="line">		&quot;bose&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Evelyn Boyd Granville - She was one of the first African-American woman to receive a Ph.D. in mathematics; she earned it in 1949 from Yale University. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Evelyn\_Boyd\_Granville</span><br><span class="line">		&quot;boyd&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Brahmagupta - Ancient Indian mathematician during 598-670 CE who gave rules to compute with zero - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Brahmagupta#Zero</span><br><span class="line">		&quot;brahmagupta&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Walter Houser Brattain co-invented the transistor - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Walter\_Houser\_Brattain</span><br><span class="line">		&quot;brattain&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Emmett Brown invented time travel. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Emmett\_Brown (thanks Brian Goff)</span><br><span class="line">		&quot;brown&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Rachel Carson - American marine biologist and conservationist, her book Silent Spring and other writings are credited with advancing the global environmental movement. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Rachel\_Carson</span><br><span class="line">		&quot;carson&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Subrahmanyan Chandrasekhar - Astrophysicist known for his mathematical theory on different stages and evolution in structures of the stars. He has won nobel prize for physics - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Subrahmanyan\_Chandrasekhar</span><br><span class="line">		&quot;chandrasekhar&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F;Claude Shannon - The father of information theory and founder of digital circuit design theory. (https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Claude\_Shannon)</span><br><span class="line">		&quot;shannon&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Jane Colden - American botanist widely considered the first female American botanist - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Jane\_Colden</span><br><span class="line">		&quot;colden&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Gerty Theresa Cori - American biochemist who became the third woman—and first American woman—to win a Nobel Prize in science, and the first woman to be awarded the Nobel Prize in Physiology or Medicine. Cori was born in Prague. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Gerty\_Cori</span><br><span class="line">		&quot;cori&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Seymour Roger Cray was an American electrical engineer and supercomputer architect who designed a series of computers that were the fastest in the world for decades. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Seymour\_Cray</span><br><span class="line">		&quot;cray&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; This entry reflects a husband and wife team who worked together:</span><br><span class="line">		&#x2F;&#x2F; Joan Curran was a Welsh scientist who developed radar and invented chaff, a radar countermeasure. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Joan\_Curran</span><br><span class="line">		&#x2F;&#x2F; Samuel Curran was an Irish physicist who worked alongside his wife during WWII and invented the proximity fuse. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Samuel\_Curran</span><br><span class="line">		&quot;curran&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Marie Curie discovered radioactivity. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Marie\_Curie.</span><br><span class="line">		&quot;curie&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Charles Darwin established the principles of natural evolution. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Charles\_Darwin.</span><br><span class="line">		&quot;darwin&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Leonardo Da Vinci invented too many things to list here. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Leonardo\_da\_Vinci.</span><br><span class="line">		&quot;davinci&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Edsger Wybe Dijkstra was a Dutch computer scientist and mathematical scientist. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Edsger\_W.\_Dijkstra.</span><br><span class="line">		&quot;dijkstra&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Donna Dubinsky - played an integral role in the development of personal digital assistants (PDAs) serving as CEO of Palm, Inc. and co-founding Handspring. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Donna\_Dubinsky</span><br><span class="line">		&quot;dubinsky&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Annie Easley - She was a leading member of the team which developed software for the Centaur rocket stage and one of the first African-Americans in her field. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Annie\_Easley</span><br><span class="line">		&quot;easley&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Thomas Alva Edison, prolific inventor https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Thomas\_Edison</span><br><span class="line">		&quot;edison&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Albert Einstein invented the general theory of relativity. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Albert\_Einstein</span><br><span class="line">		&quot;einstein&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Gertrude Elion - American biochemist, pharmacologist and the 1988 recipient of the Nobel Prize in Medicine - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Gertrude\_Elion</span><br><span class="line">		&quot;elion&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Douglas Engelbart gave the mother of all demos: https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Douglas\_Engelbart</span><br><span class="line">		&quot;engelbart&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Euclid invented geometry. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Euclid</span><br><span class="line">		&quot;euclid&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Leonhard Euler invented large parts of modern mathematics. https:&#x2F;&#x2F;de.wikipedia.org&#x2F;wiki&#x2F;Leonhard\_Euler</span><br><span class="line">		&quot;euler&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Pierre de Fermat pioneered several aspects of modern mathematics. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Pierre\_de\_Fermat</span><br><span class="line">		&quot;fermat&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Enrico Fermi invented the first nuclear reactor. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Enrico\_Fermi.</span><br><span class="line">		&quot;fermi&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Richard Feynman was a key contributor to quantum mechanics and particle physics. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Richard\_Feynman</span><br><span class="line">		&quot;feynman&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Benjamin Franklin is famous for his experiments in electricity and the invention of the lightning rod.</span><br><span class="line">		&quot;franklin&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Galileo was a founding father of modern astronomy, and faced politics and obscurantism to establish scientific truth.  https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Galileo\_Galilei</span><br><span class="line">		&quot;galileo&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; William Henry &quot;Bill&quot; Gates III is an American business magnate, philanthropist, investor, computer programmer, and inventor. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Bill\_Gates</span><br><span class="line">		&quot;gates&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Adele Goldberg, was one of the designers and developers of the Smalltalk language. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Adele\_Goldberg\_(computer\_scientist)</span><br><span class="line">		&quot;goldberg&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Adele Goldstine, born Adele Katz, wrote the complete technical description for the first electronic digital computer, ENIAC. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Adele\_Goldstine</span><br><span class="line">		&quot;goldstine&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Shafi Goldwasser is a computer scientist known for creating theoretical foundations of modern cryptography. Winner of 2012 ACM Turing Award. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Shafi\_Goldwasser</span><br><span class="line">		&quot;goldwasser&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; James Golick, all around gangster.</span><br><span class="line">		&quot;golick&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Jane Goodall - British primatologist, ethologist, and anthropologist who is considered to be the world&#39;s foremost expert on chimpanzees - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Jane\_Goodall</span><br><span class="line">		&quot;goodall&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Margaret Hamilton - Director of the Software Engineering Division of the MIT Instrumentation Laboratory, which developed on-board flight software for the Apollo space program. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Margaret\_Hamilton\_(scientist)</span><br><span class="line">		&quot;hamilton&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Stephen Hawking pioneered the field of cosmology by combining general relativity and quantum mechanics. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Stephen\_Hawking</span><br><span class="line">		&quot;hawking&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Werner Heisenberg was a founding father of quantum mechanics. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Werner\_Heisenberg</span><br><span class="line">		&quot;heisenberg&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Jaroslav Heyrovský was the inventor of the polarographic method, father of the electroanalytical method, and recipient of the Nobel Prize in 1959. His main field of work was polarography. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Jaroslav\_Heyrovsk%C3%BD</span><br><span class="line">		&quot;heyrovsky&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Dorothy Hodgkin was a British biochemist, credited with the development of protein crystallography. She was awarded the Nobel Prize in Chemistry in 1964. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Dorothy\_Hodgkin</span><br><span class="line">		&quot;hodgkin&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Erna Schneider Hoover revolutionized modern communication by inventing a computerized telephone switching method. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Erna\_Schneider\_Hoover</span><br><span class="line">		&quot;hoover&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Grace Hopper developed the first compiler for a computer programming language and  is credited with popularizing the term &quot;debugging&quot; for fixing computer glitches. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Grace\_Hopper</span><br><span class="line">		&quot;hopper&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Frances Hugle, she was an American scientist, engineer, and inventor who contributed to the understanding of semiconductors, integrated circuitry, and the unique electrical principles of microscopic materials. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Frances\_Hugle</span><br><span class="line">		&quot;hugle&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Hypatia - Greek Alexandrine Neoplatonist philosopher in Egypt who was one of the earliest mothers of mathematics - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Hypatia</span><br><span class="line">		&quot;hypatia&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Yeong-Sil Jang was a Korean scientist and astronomer during the Joseon Dynasty; he invented the first metal printing press and water gauge. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Jang\_Yeong-sil</span><br><span class="line">		&quot;jang&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Betty Jennings - one of the original programmers of the ENIAC. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ENIAC - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Jean\_Bartik</span><br><span class="line">		&quot;jennings&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Mary Lou Jepsen, was the founder and chief technology officer of One Laptop Per Child (OLPC), and the founder of Pixel Qi. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Mary\_Lou\_Jepsen</span><br><span class="line">		&quot;jepsen&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Irène Joliot-Curie - French scientist who was awarded the Nobel Prize for Chemistry in 1935. Daughter of Marie and Pierre Curie. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Ir%C3%A8ne\_Joliot-Curie</span><br><span class="line">		&quot;joliot&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Karen Spärck Jones came up with the concept of inverse document frequency, which is used in most search engines today. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Karen\_Sp%C3%A4rck\_Jones</span><br><span class="line">		&quot;jones&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; A. P. J. Abdul Kalam - is an Indian scientist aka Missile Man of India for his work on the development of ballistic missile and launch vehicle technology - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;A.\_P.\_J.\_Abdul\_Kalam</span><br><span class="line">		&quot;kalam&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Susan Kare, created the icons and many of the interface elements for the original Apple Macintosh in the 1980s, and was an original employee of NeXT, working as the Creative Director. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Susan\_Kare</span><br><span class="line">		&quot;kare&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Mary Kenneth Keller, Sister Mary Kenneth Keller became the first American woman to earn a PhD in Computer Science in 1965. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Mary\_Kenneth\_Keller</span><br><span class="line">		&quot;keller&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Har Gobind Khorana - Indian-American biochemist who shared the 1968 Nobel Prize for Physiology - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Har\_Gobind\_Khorana</span><br><span class="line">		&quot;khorana&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Jack Kilby invented silicone integrated circuits and gave Silicon Valley its name. - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Jack\_Kilby</span><br><span class="line">		&quot;kilby&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Maria Kirch - German astronomer and first woman to discover a comet - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Maria\_Margarethe\_Kirch</span><br><span class="line">		&quot;kirch&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Donald Knuth - American computer scientist, author of &quot;The Art of Computer Programming&quot; and creator of the TeX typesetting system. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Donald\_Knuth</span><br><span class="line">		&quot;knuth&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Sophie Kowalevski - Russian mathematician responsible for important original contributions to analysis, differential equations and mechanics - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Sofia\_Kovalevskaya</span><br><span class="line">		&quot;kowalevski&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Marie-Jeanne de Lalande - French astronomer, mathematician and cataloguer of stars - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Marie-Jeanne\_de\_Lalande</span><br><span class="line">		&quot;lalande&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Hedy Lamarr - Actress and inventor. The principles of her work are now incorporated into modern Wi-Fi, CDMA and Bluetooth technology. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Hedy\_Lamarr</span><br><span class="line">		&quot;lamarr&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Leslie B. Lamport - American computer scientist. Lamport is best known for his seminal work in distributed systems and was the winner of the 2013 Turing Award. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Leslie\_Lamport</span><br><span class="line">		&quot;lamport&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Mary Leakey - British paleoanthropologist who discovered the first fossilized Proconsul skull - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Mary\_Leakey</span><br><span class="line">		&quot;leakey&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Henrietta Swan Leavitt - she was an American astronomer who discovered the relation between the luminosity and the period of Cepheid variable stars. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Henrietta\_Swan\_Leavitt</span><br><span class="line">		&quot;leavitt&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Ruth Lichterman - one of the original programmers of the ENIAC. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ENIAC - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Ruth\_Teitelbaum</span><br><span class="line">		&quot;lichterman&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Barbara Liskov - co-developed the Liskov substitution principle. Liskov was also the winner of the Turing Prize in 2008. - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Barbara\_Liskov</span><br><span class="line">		&quot;liskov&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Ada Lovelace invented the first algorithm. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Ada\_Lovelace (thanks James Turnbull)</span><br><span class="line">		&quot;lovelace&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Auguste and Louis Lumière - the first filmmakers in history - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Auguste\_and\_Louis\_Lumi%C3%A8re</span><br><span class="line">		&quot;lumiere&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Mahavira - Ancient Indian mathematician during 9th century AD who discovered basic algebraic identities - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Mah%C4%81v%C4%ABra\_(mathematician)</span><br><span class="line">		&quot;mahavira&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Maria Mayer - American theoretical physicist and Nobel laureate in Physics for proposing the nuclear shell model of the atomic nucleus - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Maria\_Mayer</span><br><span class="line">		&quot;mayer&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; John McCarthy invented LISP: https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;John\_McCarthy\_(computer\_scientist)</span><br><span class="line">		&quot;mccarthy&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Barbara McClintock - a distinguished American cytogeneticist, 1983 Nobel Laureate in Physiology or Medicine for discovering transposons. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Barbara\_McClintock</span><br><span class="line">		&quot;mcclintock&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Malcolm McLean invented the modern shipping container: https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Malcom\_McLean</span><br><span class="line">		&quot;mclean&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Kay McNulty - one of the original programmers of the ENIAC. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ENIAC - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Kathleen\_Antonelli</span><br><span class="line">		&quot;mcnulty&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Lise Meitner - Austrian&#x2F;Swedish physicist who was involved in the discovery of nuclear fission. The element meitnerium is named after her - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Lise\_Meitner</span><br><span class="line">		&quot;meitner&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Carla Meninsky, was the game designer and programmer for Atari 2600 games Dodge &#39;Em and Warlords. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Carla\_Meninsky</span><br><span class="line">		&quot;meninsky&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Johanna Mestorf - German prehistoric archaeologist and first female museum director in Germany - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Johanna\_Mestorf</span><br><span class="line">		&quot;mestorf&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Marvin Minsky - Pioneer in Artificial Intelligence, co-founder of the MIT&#39;s AI Lab, won the Turing Award in 1969. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Marvin\_Minsky</span><br><span class="line">		&quot;minsky&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Maryam Mirzakhani - an Iranian mathematician and the first woman to win the Fields Medal. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Maryam\_Mirzakhani</span><br><span class="line">		&quot;mirzakhani&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Samuel Morse - contributed to the invention of a single-wire telegraph system based on European telegraphs and was a co-developer of the Morse code - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Samuel\_Morse</span><br><span class="line">		&quot;morse&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Ian Murdock - founder of the Debian project - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Ian\_Murdock</span><br><span class="line">		&quot;murdock&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Isaac Newton invented classic mechanics and modern optics. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Isaac\_Newton</span><br><span class="line">		&quot;newton&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Florence Nightingale, more prominently known as a nurse, was also the first female member of the Royal Statistical Society and a pioneer in statistical graphics https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Florence\_Nightingale#Statistics\_and\_sanitary\_reform</span><br><span class="line">		&quot;nightingale&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Alfred Nobel - a Swedish chemist, engineer, innovator, and armaments manufacturer (inventor of dynamite) - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Alfred\_Nobel</span><br><span class="line">		&quot;nobel&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Emmy Noether, German mathematician. Noether&#39;s Theorem is named after her. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Emmy\_Noether</span><br><span class="line">		&quot;noether&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Poppy Northcutt. Poppy Northcutt was the first woman to work as part of NASA’s Mission Control. http:&#x2F;&#x2F;www.businessinsider.com&#x2F;poppy-northcutt-helped-apollo-astronauts-2014-12?op&#x3D;1</span><br><span class="line">		&quot;northcutt&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Robert Noyce invented silicone integrated circuits and gave Silicon Valley its name. - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Robert\_Noyce</span><br><span class="line">		&quot;noyce&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Panini - Ancient Indian linguist and grammarian from 4th century CE who worked on the world&#39;s first formal system - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;P%C4%81%E1%B9%87ini#Comparison\_with\_modern\_formal\_systems</span><br><span class="line">		&quot;panini&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Ambroise Pare invented modern surgery. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Ambroise\_Par%C3%A9</span><br><span class="line">		&quot;pare&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Louis Pasteur discovered vaccination, fermentation and pasteurization. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Louis\_Pasteur.</span><br><span class="line">		&quot;pasteur&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Cecilia Payne-Gaposchkin was an astronomer and astrophysicist who, in 1925, proposed in her Ph.D. thesis an explanation for the composition of stars in terms of the relative abundances of hydrogen and helium. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Cecilia\_Payne-Gaposchkin</span><br><span class="line">		&quot;payne&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Radia Perlman is a software designer and network engineer and most famous for her invention of the spanning-tree protocol (STP). https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Radia\_Perlman</span><br><span class="line">		&quot;perlman&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Rob Pike was a key contributor to Unix, Plan 9, the X graphic system, utf-8, and the Go programming language. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Rob\_Pike</span><br><span class="line">		&quot;pike&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Henri Poincaré made fundamental contributions in several fields of mathematics. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Henri\_Poincar%C3%A9</span><br><span class="line">		&quot;poincare&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Laura Poitras is a director and producer whose work, made possible by open source crypto tools, advances the causes of truth and freedom of information by reporting disclosures by whistleblowers such as Edward Snowden. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Laura\_Poitras</span><br><span class="line">		&quot;poitras&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Claudius Ptolemy - a Greco-Egyptian writer of Alexandria, known as a mathematician, astronomer, geographer, astrologer, and poet of a single epigram in the Greek Anthology - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Ptolemy</span><br><span class="line">		&quot;ptolemy&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; C. V. Raman - Indian physicist who won the Nobel Prize in 1930 for proposing the Raman effect. - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;C.\_V.\_Raman</span><br><span class="line">		&quot;raman&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Srinivasa Ramanujan - Indian mathematician and autodidact who made extraordinary contributions to mathematical analysis, number theory, infinite series, and continued fractions. - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Srinivasa\_Ramanujan</span><br><span class="line">		&quot;ramanujan&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Sally Kristen Ride was an American physicist and astronaut. She was the first American woman in space, and the youngest American astronaut. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Sally\_Ride</span><br><span class="line">		&quot;ride&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Rita Levi-Montalcini - Won Nobel Prize in Physiology or Medicine jointly with colleague Stanley Cohen for the discovery of nerve growth factor (https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Rita\_Levi-Montalcini)</span><br><span class="line">		&quot;montalcini&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Dennis Ritchie - co-creator of UNIX and the C programming language. - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Dennis\_Ritchie</span><br><span class="line">		&quot;ritchie&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Wilhelm Conrad Röntgen - German physicist who was awarded the first Nobel Prize in Physics in 1901 for the discovery of X-rays (Röntgen rays). https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Wilhelm\_R%C3%B6ntgen</span><br><span class="line">		&quot;roentgen&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Rosalind Franklin - British biophysicist and X-ray crystallographer whose research was critical to the understanding of DNA - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Rosalind\_Franklin</span><br><span class="line">		&quot;rosalind&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Meghnad Saha - Indian astrophysicist best known for his development of the Saha equation, used to describe chemical and physical conditions in stars - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Meghnad\_Saha</span><br><span class="line">		&quot;saha&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Jean E. Sammet developed FORMAC, the first widely used computer language for symbolic manipulation of mathematical formulas. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Jean\_E.\_Sammet</span><br><span class="line">		&quot;sammet&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Carol Shaw - Originally an Atari employee, Carol Shaw is said to be the first female video game designer. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Carol\_Shaw\_(video\_game\_designer)</span><br><span class="line">		&quot;shaw&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Dame Stephanie &quot;Steve&quot; Shirley - Founded a software company in 1962 employing women working from home. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Steve\_Shirley</span><br><span class="line">		&quot;shirley&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; William Shockley co-invented the transistor - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;William\_Shockley</span><br><span class="line">		&quot;shockley&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Françoise Barré-Sinoussi - French virologist and Nobel Prize Laureate in Physiology or Medicine; her work was fundamental in identifying HIV as the cause of AIDS. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Fran%C3%A7oise\_Barr%C3%A9-Sinoussi</span><br><span class="line">		&quot;sinoussi&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Betty Snyder - one of the original programmers of the ENIAC. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ENIAC - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Betty\_Holberton</span><br><span class="line">		&quot;snyder&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Frances Spence - one of the original programmers of the ENIAC. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ENIAC - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Frances\_Spence</span><br><span class="line">		&quot;spence&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Richard Matthew Stallman - the founder of the Free Software movement, the GNU project, the Free Software Foundation, and the League for Programming Freedom. He also invented the concept of copyleft to protect the ideals of this movement, and enshrined this concept in the widely-used GPL (General Public License) for software. https:&#x2F;&#x2F;en.wikiquote.org&#x2F;wiki&#x2F;Richard\_Stallman</span><br><span class="line">		&quot;stallman&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Michael Stonebraker is a database research pioneer and architect of Ingres, Postgres, VoltDB and SciDB. Winner of 2014 ACM Turing Award. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Michael\_Stonebraker</span><br><span class="line">		&quot;stonebraker&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Janese Swanson (with others) developed the first of the Carmen Sandiego games. She went on to found Girl Tech. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Janese\_Swanson</span><br><span class="line">		&quot;swanson&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Aaron Swartz was influential in creating RSS, Markdown, Creative Commons, Reddit, and much of the internet as we know it today. He was devoted to freedom of information on the web. https:&#x2F;&#x2F;en.wikiquote.org&#x2F;wiki&#x2F;Aaron\_Swartz</span><br><span class="line">		&quot;swartz&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Bertha Swirles was a theoretical physicist who made a number of contributions to early quantum theory. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Bertha\_Swirles</span><br><span class="line">		&quot;swirles&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Nikola Tesla invented the AC electric system and every gadget ever used by a James Bond villain. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Nikola\_Tesla</span><br><span class="line">		&quot;tesla&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Ken Thompson - co-creator of UNIX and the C programming language - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Ken\_Thompson</span><br><span class="line">		&quot;thompson&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Linus Torvalds invented Linux and Git. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Linus\_Torvalds</span><br><span class="line">		&quot;torvalds&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Alan Turing was a founding father of computer science. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Alan\_Turing.</span><br><span class="line">		&quot;turing&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Varahamihira - Ancient Indian mathematician who discovered trigonometric formulae during 505-587 CE - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Var%C4%81hamihira#Contributions</span><br><span class="line">		&quot;varahamihira&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Sir Mokshagundam Visvesvaraya - is a notable Indian engineer.  He is a recipient of the Indian Republic&#39;s highest honour, the Bharat Ratna, in 1955. On his birthday, 15 September is celebrated as Engineer&#39;s Day in India in his memory - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Visvesvaraya</span><br><span class="line">		&quot;visvesvaraya&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Christiane Nüsslein-Volhard - German biologist, won Nobel Prize in Physiology or Medicine in 1995 for research on the genetic control of embryonic development. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Christiane\_N%C3%BCsslein-Volhard</span><br><span class="line">		&quot;volhard&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Marlyn Wescoff - one of the original programmers of the ENIAC. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;ENIAC - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Marlyn\_Meltzer</span><br><span class="line">		&quot;wescoff&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Andrew Wiles - Notable British mathematician who proved the enigmatic Fermat&#39;s Last Theorem - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Andrew\_Wiles</span><br><span class="line">		&quot;wiles&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Roberta Williams, did pioneering work in graphical adventure games for personal computers, particularly the King&#39;s Quest series. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Roberta\_Williams</span><br><span class="line">		&quot;williams&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Sophie Wilson designed the first Acorn Micro-Computer and the instruction set for ARM processors. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Sophie\_Wilson</span><br><span class="line">		&quot;wilson&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Jeannette Wing - co-developed the Liskov substitution principle. - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Jeannette\_Wing</span><br><span class="line">		&quot;wing&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Steve Wozniak invented the Apple I and Apple II. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Steve\_Wozniak</span><br><span class="line">		&quot;wozniak&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; The Wright brothers, Orville and Wilbur - credited with inventing and building the world&#39;s first successful airplane and making the first controlled, powered and sustained heavier-than-air human flight - https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Wright\_brothers</span><br><span class="line">		&quot;wright&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Rosalyn Sussman Yalow - Rosalyn Sussman Yalow was an American medical physicist, and a co-winner of the 1977 Nobel Prize in Physiology or Medicine for development of the radioimmunoassay technique. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Rosalyn\_Sussman\_Yalow</span><br><span class="line">		&quot;yalow&quot;,</span><br><span class="line"></span><br><span class="line">		&#x2F;&#x2F; Ada Yonath - an Israeli crystallographer, the first woman from the Middle East to win a Nobel prize in the sciences. https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Ada\_Yonath</span><br><span class="line">		&quot;yonath&quot;,</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; GetRandomName generates a random name from the list of adjectives and surnames in this package</span><br><span class="line">&#x2F;&#x2F; formatted as &quot;adjective\_surname&quot;. For example &#39;focused\_turing&#39;. If retry is non-zero, a random</span><br><span class="line">&#x2F;&#x2F; integer between 0 and 10 will be added to the end of the name, e.g \&#96;focused\_turing3\&#96;</span><br><span class="line">func GetRandomName(retry int) string &#123;</span><br><span class="line">	rnd :&#x3D; random.Rand</span><br><span class="line">begin:</span><br><span class="line">	name :&#x3D; fmt.Sprintf(&quot;%s\_%s&quot;, left\[rnd.Intn(len(left))\], right\[rnd.Intn(len(right))\])</span><br><span class="line">	if name &#x3D;&#x3D; &quot;boring\_wozniak&quot; &#x2F;\* Steve Wozniak is not boring \*&#x2F; &#123;</span><br><span class="line">		goto begin</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	if retry &gt; 0 &#123;</span><br><span class="line">		name &#x3D; fmt.Sprintf(&quot;%s%d&quot;, name, rnd.Intn(10))</span><br><span class="line">	&#125;</span><br><span class="line">	return name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Docker-Volume-Plugin-%E5%BC%80%E5%8F%91%E5%8F%8AGolang%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Docker-Volume-Plugin-%E5%BC%80%E5%8F%91%E5%8F%8AGolang%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">Docker Volume Plugin 开发及Golang实现</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:28:02 / 修改时间：19:59:12" itemprop="dateCreated datePublished" datetime="2020-09-21T19:28:02+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>      该项目要用于生产环境了，完善加固了一下代码，顺便更新一下文章。</p>
<p>     在加固项目的代码时候 ，调整了卷创建的顺序，调用docker volume create的时候，就把lv创建出来，并挂载到了本地目录，中间遇到了一个很奇怪的问题，挂载lv代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">err &#x3D; syscall.Mount(lvdiskname, mountPoint, &quot;xfs&quot;, syscall.MS\_NOSUID|syscall.MS\_STRICTATIME, &quot;&quot;)</span><br><span class="line"></span><br><span class="line">	if err !&#x3D; nil &#123;</span><br><span class="line">		log.Error(&quot;mount lv failed&quot;, err)</span><br><span class="line">			return volume.Response&#123;Err: &quot;mount lv failed&quot;&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<p>      使用该代码挂载完成后，在命令行执行df -h 命令是无法查看到挂载信息的，代码也没有报错，尝试把lv删除时，会出现 Device busy的错误。数据并没有丢失，可以在容器内正常使用。</p>
<p>google到了 mount namespace的概念。</p>
<p>``<br>     mnt namespace为进程提供独立的文件系统视图。当clone（）函数中带有CLONE_NEWNS标志时，新的mnt ns在子进程中被创建，新的mnt ns是一份父mnt ns的拷贝，<br>但是在子进程中调用mount安装的文件系统，将独立于父进程的mnt ns，只出现在新的mnt ns上<br>使用syscall.Mount 函数应该是在另一个namespace 中进行了挂载，因此我是无法查看到。</p>
<p>    前期的项目需求，需要合理利用宿主机的存储，利用在宿主机部署Agent的方式，实现了基于LVM分配Docker数据卷的方式，随着开发的进行，项目想要集成docker compose 完成应用的自动编排，需要在docker compose中为容器创建数据卷并且指定卷大小，之前的采用agent的模式已经无法满足目前的需求。参考<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/extend/plugins_volume/">docker 官方文档</a> 和 <a target="_blank" rel="noopener" href="https://github.com/CWSpear/local-persist">Local-Persist</a>项目，实现了一个基于LVM的volume 插件 <a target="_blank" rel="noopener" href="https://github.com/davidstack/docker-volume-plugin-lvm">docker-volume-plugin-lvm</a>。</p>
<p>      Docker Volume Plugin 提供了标准的卷管理API，第三方只需要实现这些API就可以了。</p>
<p>     插件加载方式，将自己实现的Driver注册，启动main函数，实际上是启动了一个监听端口，sock文件：/var/run/docker/plugins/LVM.sock</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">func main() &#123;</span><br><span class="line">	driver :&#x3D; NewLvmPersistDriver()</span><br><span class="line"></span><br><span class="line">	handler :&#x3D; volume.NewHandler(driver)</span><br><span class="line">	fmt.Println(handler.ServeUnix(&quot;root&quot;, driver.Name))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p> 查询卷API：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func (driver \*LvmPersistDriver) Get(req volume.Request) volume.Response</span><br></pre></td></tr></table></figure>





<p>       创建卷API：根据入参获取卷名称和卷大小，在LVM的VG中分配LV，并将卷的元数据保存到内存并持久化，若没有设置卷大小，可以设置默认值（目前只能通过代码修改） PS：在使用docker create 命令创建容器时，无法指定卷大小比较坑，还好docker compose支持</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func (driver \*LvmPersistDriver) Create(req volume.Request) volume.Response</span><br><span class="line">&#96;&#96;&#96;    挂载卷API：根据入参获取卷名称，校验该卷是否已经存在，若存在，将该LV格式化，并挂载到宿主机的目录（宿主机目录由卷插件指定）（若宿主机目录已经被挂载，则不执行该步骤），将挂载点，也就是宿主机目录以volume.Response的方式返回，PS：支持多个容器挂载同一个数据卷，但是读写控制目前没有实现，需要Container自己控制。</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>func (driver *LvmPersistDriver) Mount(req volume.Request) volume.Response</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  卸载卷API：&#96;&#96;&#96;</span><br><span class="line">func (driver \*LvmPersistDriver) Unmount(req volume.Request) volume.Response</span><br></pre></td></tr></table></figure>



<p>删除卷API：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func (driver \*LvmPersistDriver) Remove(req volume.Request) volume.Response</span><br></pre></td></tr></table></figure>
<p>具体实现可以参考代码实现。<a target="_blank" rel="noopener" href="https://github.com/davidstack/docker-volume-plugin-lvm">docker-volume-plugin-lvm</a></p>
<p>代码目前不是很完善，测试代码，部署运行代码 还没有实现。我比较懒。。。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Etcd%E7%9A%84db%E6%96%87%E4%BB%B6%E5%BE%88%E5%A4%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Etcd%E7%9A%84db%E6%96%87%E4%BB%B6%E5%BE%88%E5%A4%A7/" class="post-title-link" itemprop="url">Etcd的db文件很大</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:27:00 / 修改时间：19:59:12" itemprop="dateCreated datePublished" datetime="2020-09-21T19:27:00+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>     Etcd运行一段时间后，发现db占用的空间很大，将etcd内的数据导出，发现只有180多k,为什么会占用这么多空间呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@node3 snap]# pwd</span><br><span class="line">&#x2F;var&#x2F;lib&#x2F;etcd&#x2F;member&#x2F;snap</span><br><span class="line">[root@node3 snap]# ll -lh</span><br><span class="line">total 509M</span><br><span class="line">-rw-r--r-- 1 root root 390K Jun 14 12:31 000000000001a198-0000000001357eb0.snap</span><br><span class="line">-rw-r--r-- 1 root root 390K Jun 14 13:11 000000000001a198-000000000135a5c3.snap</span><br><span class="line">-rw-r--r-- 1 root root 390K Jun 14 13:52 000000000001a198-000000000135ccd5.snap</span><br><span class="line">-rw-r--r-- 1 root root 390K Jun 14 14:29 000000000001a198-000000000135f3e6.snap</span><br><span class="line">-rw-r--r-- 1 root root 391K Jun 14 14:50 000000000001a19a-0000000001361af7.snap</span><br><span class="line">-rw------- 1 root root 523M Jun 14 15:05 db</span><br></pre></td></tr></table></figure>

<p>    看一下一下etcd官方的说明</p>
<p>          since etcd keeps an exact history of its keyspace, this history should be periodically compacted to avoid performance degradation and eventual storage space exhaustion。</p>
<p>意思就是etcd保存了keys的历史信息，所以会占用的空间比较大，需要周期的进行压缩，以避免出现性能下降和存储资源耗尽，继续看官方说明</p>
<p>         After compacting the keyspace, the backend database may exhibit internal fragmentation. Any internal fragmentation is space that is free to use by the backend but still consumes storage space. The process of defragmentation releases this storage space back to the file system. Defragmentation is issued on a per-member so that cluster-wide latency spikes may be avoided</p>
<p>     大概的意思是定期压缩etcd 的db后，虽然释放了一些空间，但是只能被etcd使用，并不能被宿主机使用，根据上面的解释，如果不是etcd突然释放大量keys或者etcd需求大量磁盘的场景下，只需要执行compact就可以了，执行defrag是对硬盘的一些操作而已。</p>
<p>     解决方法：</p>
<p>etcd的启动参数增加ETCD_AUTO_COMPACTION_RETENTION=1，如果需要释放硬盘空间，可以执行defrag命令，如下所示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 snap]# etcdctl --endpoints http:&#x2F;&#x2F;10.110.17.119:2379  defrag</span><br><span class="line">Finished defragmenting etcd member\[http:&#x2F;&#x2F;10.110.17.119:2379\]</span><br><span class="line">[root@node2 snap]# ll -lh</span><br><span class="line">total 3.0M</span><br><span class="line">-rw-r--r-- 1 root root 390K Jun 14 13:08 000000000001a198-000000000135a24e.snap</span><br><span class="line">-rw-r--r-- 1 root root 390K Jun 14 13:48 000000000001a198-000000000135c961.snap</span><br><span class="line">-rw-r--r-- 1 root root 390K Jun 14 14:27 000000000001a198-000000000135f072.snap</span><br><span class="line">-rw-r--r-- 1 root root 390K Jun 14 14:48 000000000001a19a-0000000001361783.snap</span><br><span class="line">-rw-r--r-- 1 root root 390K Jun 14 15:09 000000000001a19b-0000000001363e96.snap</span><br><span class="line">-rw------- 1 root root  18M Jun 14 15:20 db</span><br></pre></td></tr></table></figure>

<p>附：</p>
<p>Etcd默认的db 配额是2GB，etcd主要用于存储元数据，这个一般就够用了。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Golang-%E8%AF%BB%E5%8F%96%E5%86%99%E5%85%A5Etcd%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Golang-%E8%AF%BB%E5%8F%96%E5%86%99%E5%85%A5Etcd%E6%95%B0%E6%8D%AE%E5%BA%93/" class="post-title-link" itemprop="url">Golang 读取写入Etcd数据库</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:19:50 / 修改时间：19:23:08" itemprop="dateCreated datePublished" datetime="2020-09-21T19:19:50+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>           项目中用到Etcd数据库来存储容器的信息和应用的域名信息，将操作Etcd的golang代码整理了一下</p>
<p>1、将Container信息写入到指定目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">c, err :&#x3D; common.GetEtcdClient()</span><br><span class="line">	if err !&#x3D; nil &#123;</span><br><span class="line">		beego.Error(&quot;get etcd client failed&quot;)</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line">	kapi :&#x3D; client.NewKeysAPI(c)</span><br><span class="line">	key :&#x3D; getSkyDnsDomain(domainEtcd.Domain)</span><br><span class="line">	value, \_ :&#x3D; json.Marshal(domainEtcd)</span><br><span class="line">	var etcderr error</span><br><span class="line">	common.HaproxyTemplateCache.Lock.Lock()</span><br><span class="line">	defer common.HaproxyTemplateCache.Lock.Unlock()</span><br><span class="line"></span><br><span class="line">	switch domainEtcd.Action &#123;</span><br><span class="line">	case &quot;add&quot;:</span><br><span class="line">		\_, etcderr &#x3D; kapi.Create(context.Background(), key, string(value))</span><br><span class="line">		common.HaproxyTemplateCache.Data\[domainEtcd.Domain\] &#x3D; &amp;models.HaproxyConfigration&#123;</span><br><span class="line">			DomainEtcd: domainEtcd,</span><br><span class="line">		&#125;</span><br><span class="line">	case &quot;delete&quot;:</span><br><span class="line">		\_, etcderr &#x3D; kapi.Delete(context.Background(), key, &amp;client.DeleteOptions&#123;&#125;)</span><br><span class="line">		delete(common.HaproxyTemplateCache.Data, domainEtcd.Domain)</span><br><span class="line">	&#125;</span><br><span class="line">	if etcderr !&#x3D; nil &#123;</span><br><span class="line">		beego.Error(&quot;updatecontainer event erro&quot;, etcderr)</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>2、读取Etcd的缓存数据 example，只获取其中的非目录信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">func loadHaproxyTemplateCache() &#123;</span><br><span class="line">	HaproxyTemplateCache.Lock.Lock()</span><br><span class="line">	defer HaproxyTemplateCache.Lock.Unlock()</span><br><span class="line">	HaproxyTemplateCache.Data &#x3D; make(map\[string\]\*models.HaproxyConfigration)</span><br><span class="line">	client1, \_ :&#x3D; GetEtcdClient()</span><br><span class="line">	api :&#x3D; client.NewKeysAPI(client1)</span><br><span class="line">	&#x2F;\*set skydns domain info\*&#x2F;</span><br><span class="line">	res, err1 :&#x3D; api.Get(context.Background(), &quot;&#x2F;skydns&#x2F;local&quot;, &amp;client.GetOptions&#123;Recursive: true&#125;)</span><br><span class="line">	if err1 !&#x3D; nil &#123;</span><br><span class="line">		beego.Error(&quot;get &#x2F;dockerstack info failed&quot;)</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	skydnsNodesInfo :&#x3D; make(map\[string\]string)</span><br><span class="line">	getAllNode(res.Node, skydnsNodesInfo)</span><br><span class="line">	var domain models.DomainEtcd</span><br><span class="line">	for \_, domainStr :&#x3D; range skydnsNodesInfo &#123;</span><br><span class="line">		json.Unmarshal(\[\]byte(domainStr), &amp;domain)</span><br><span class="line">		HaproxyTemplateCache.Data\[domain.Domain\].DomainEtcd &#x3D; &amp;domain</span><br><span class="line">	&#125;</span><br><span class="line">	&#x2F;\*set dockerstack container info\*&#x2F;</span><br><span class="line">	res, err1 &#x3D; api.Get(context.Background(), &quot;&#x2F;dockerstack&quot;, &amp;client.GetOptions&#123;Recursive: true&#125;)</span><br><span class="line">	if err1 !&#x3D; nil &#123;</span><br><span class="line">		beego.Error(&quot;get &#x2F;dockerstack info failed&quot;)</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line">	dockerstackNodesInfo :&#x3D; make(map\[string\]string)</span><br><span class="line">	getAllNode(res.Node, dockerstackNodesInfo)</span><br><span class="line">	var container models.ContainerEtcd</span><br><span class="line">	for \_, containerStr :&#x3D; range skydnsNodesInfo &#123;</span><br><span class="line">		json.Unmarshal(\[\]byte(containerStr), &amp;container)</span><br><span class="line">		HaproxyTemplateCache.Data\[domain.Domain\].Containers\[container.ContainerId\] &#x3D; &amp;container</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">func getAllNode(rootNode \*client.Node, nodesInfo map\[string\]string) &#123;</span><br><span class="line">	if !rootNode.Dir &#123;</span><br><span class="line">		nodesInfo\[rootNode.Key\] &#x3D; rootNode.Value</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line">	for node :&#x3D; range rootNode.Nodes &#123;</span><br><span class="line">		getAllNode(rootNode.Nodes\[node\], nodesInfo)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>附 etcd存储的数据结构信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;the container info in etcd</span><br><span class="line">type ContainerEtcd struct &#123;</span><br><span class="line">	HostIp        string</span><br><span class="line">	HostPort      int64</span><br><span class="line">	Domain        string</span><br><span class="line">	ContainerId   string</span><br><span class="line">	ContainerIp   string</span><br><span class="line">	ContainerPort int64</span><br><span class="line">	Action        string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;domain info in etcd</span><br><span class="line">type DomainEtcd struct &#123;</span><br><span class="line">	Port   int64</span><br><span class="line">	Host   string</span><br><span class="line">	Domain string</span><br><span class="line">	Action string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type HaproxyConfigration struct &#123;</span><br><span class="line">	DomainEtcd \*DomainEtcd</span><br><span class="line">	Containers map\[string\]\*ContainerEtcd</span><br><span class="line">&#125;</span><br><span class="line">type HaproxyTemplateCache struct &#123;</span><br><span class="line">	Data map\[string\]\*HaproxyConfigration</span><br><span class="line">	Lock sync.RWMutex</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本文只是想提供一些代码参考，业务内容就不细讲了。。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://damonyi.cc/2020/09/21/Kubernetes-%E4%B8%AD%E7%9A%84port%E3%80%81nodePort%E3%80%81targetPort/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="雾里云里">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/09/21/Kubernetes-%E4%B8%AD%E7%9A%84port%E3%80%81nodePort%E3%80%81targetPort/" class="post-title-link" itemprop="url">Kubernetes 中的port、nodePort、targetPort</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 19:15:09 / 修改时间：19:23:08" itemprop="dateCreated datePublished" datetime="2020-09-21T19:15:09+08:00">2020-09-21</time>
    </span>

  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>892</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Kubernetes 在定义Service的时候有几个Port需要澄清一下，例如下面的Service定义  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1  </span><br><span class="line">kind: Service  </span><br><span class="line">metadata:  </span><br><span class="line">  labels:  </span><br><span class="line">    name: app1  </span><br><span class="line">  name: app1  </span><br><span class="line">  namespace: default  </span><br><span class="line">spec:  </span><br><span class="line">  type: NodePort  </span><br><span class="line">  ports:  </span><br><span class="line">  - port: 8080  </span><br><span class="line">    targetPort: 8080  </span><br><span class="line">    nodePort: 30062&lt;&#x2F;strong&gt;  </span><br><span class="line">  selector:  </span><br><span class="line">    name: app1</span><br></pre></td></tr></table></figure>

<p>参考官方的解释  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Port：</span><br><span class="line">The port that the service is exposed on the service’s cluster ip (virsual ip). Port is the service port which is accessed by others with cluster ip.</span><br></pre></td></tr></table></figure>

<p>  Port是在Service IP中使用的，使用Service IP +Port就可以访问到服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TargetPort：</span><br><span class="line">The port on the pod that the service should proxy traffic to.</span><br></pre></td></tr></table></figure>

<p>  TargetPort 说的是Pod内的应用暴露的服务端口，Service IP+Port的访问会被代理到这个Target Port  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NodePort：</span><br><span class="line">On top of having a cluster-internal IP, expose the service on a port on each node of the cluster (the same port on each node). You&#39;ll be able to contact the service on any</span><br><span class="line"></span><br><span class="line">&lt;nodeIP&gt;:nodePort</span><br><span class="line">address. So nodePort is alse the service port which can be accessed by the node ip by others with external ip.</span><br></pre></td></tr></table></figure>

<p>NodePort是Kubernetes集群提供给外部客户端访问Service 使用的端口，一般是主机IP+NodePort 就可以访问到该服务</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>


<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">205k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">3:06</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  







  






</body>
</html>

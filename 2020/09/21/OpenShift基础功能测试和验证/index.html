<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="c5YHonM6Ek6i_dIKMceKoszIqEtrVddsax9qcaoQfR4" />














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="OpenShiftOpenShift 分布式部署OpenShift Slave节点配置0、 节点ssh互信设置 Maste节点执行 123456ssh-keygen# for host in master.example.com \\    node1.example.com \\    node2.example.com; \\    do ssh-copy-id -i ~&#x2F;.ssh&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenShift基础功能测试和验证">
<meta property="og:url" content="https://damonyi.cc/2020/09/21/OpenShift%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E5%92%8C%E9%AA%8C%E8%AF%81/index.html">
<meta property="og:site_name" content="云里雾里">
<meta property="og:description" content="OpenShiftOpenShift 分布式部署OpenShift Slave节点配置0、 节点ssh互信设置 Maste节点执行 123456ssh-keygen# for host in master.example.com \\    node1.example.com \\    node2.example.com; \\    do ssh-copy-id -i ~&#x2F;.ssh&amp;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="file://C:/Users/wangd/AppData/Local/Temp/msohtmlclip1/01/clip_image005.jpg">
<meta property="article:published_time" content="2020-09-21T10:36:48.000Z">
<meta property="article:modified_time" content="2020-09-21T11:23:08.233Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="file://C:/Users/wangd/AppData/Local/Temp/msohtmlclip1/01/clip_image005.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://damonyi.cc/2020/09/21/OpenShift基础功能测试和验证/"/>





  <title>OpenShift基础功能测试和验证 | 云里雾里</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">云里雾里</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://damonyi.cc/2020/09/21/OpenShift%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E5%92%8C%E9%AA%8C%E8%AF%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="云里雾里">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">OpenShift基础功能测试和验证</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-21T18:36:48+08:00">
                2020-09-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="OpenShift"><a href="#OpenShift" class="headerlink" title="OpenShift"></a>OpenShift</h1><h2 id="OpenShift-分布式部署"><a href="#OpenShift-分布式部署" class="headerlink" title="OpenShift 分布式部署"></a>OpenShift 分布式部署</h2><h3 id="OpenShift-Slave节点配置"><a href="#OpenShift-Slave节点配置" class="headerlink" title="OpenShift Slave节点配置"></a>OpenShift Slave节点配置</h3><p>0、 节点ssh互信设置</p>
<p>Maste节点执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br><span class="line"># for host in master.example.com \\</span><br><span class="line">    node1.example.com \\</span><br><span class="line">    node2.example.com; \\</span><br><span class="line">    do ssh-copy-id -i ~&#x2F;.ssh&#x2F;id\_rsa.pub $host; \\</span><br><span class="line">    done</span><br></pre></td></tr></table></figure>

<p>1、 每个节点都需要安装docker，手动安装</p>
<p>2、设置每个节点的docker 存储，使用数据盘做为docker的存储</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\[root@origin-master member\]# cat &#x2F;etc&#x2F;sysconfig&#x2F;docker-storage-setup</span><br><span class="line"> Edit this file to override any configuration options specified in</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;docker-storage-setup&#x2F;docker-storage-setup.</span><br><span class="line"></span><br><span class="line">For more details refer to &quot;man docker-storage-setup&quot;</span><br><span class="line">DEVS&#x3D;&#x2F;dev&#x2F;vdb</span><br><span class="line">VG&#x3D;docker-vg</span><br><span class="line"> </span><br><span class="line">docker-storage-setup</span><br><span class="line"> </span><br><span class="line">systemctl stop docker</span><br><span class="line">rm -rf &#x2F;var&#x2F;lib&#x2F;docker&#x2F;\*</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>

<p>3、</p>
<p>设置每个节点的docker 可信镜像地址/etc/sysconfig/docker（这一操作，可以在部署完成openshift后，进行修改，其中172.30.0.0/16为ansible配置，10.110.17.138:5000为外部的docker镜像源）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPTIONS&#x3D;&#39;--insecure-registry&#x3D;10.110.17.138:5000 --insecure-registry&#x3D;172.30.0.0&#x2F;16    &#39;</span><br></pre></td></tr></table></figure>





<p>4、在DNS为每个Node的配置</p>
<p> A记录参考配置:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">root@origin-dns:&#x2F;etc&#x2F;bind# cat &#x2F;etc&#x2F;bind&#x2F;named.conf.local</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F; Do any local configuration here</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line"> </span><br><span class="line">&#x2F;&#x2F; Consider adding the 1918 zones here, if they are not used in your</span><br><span class="line">&#x2F;&#x2F; organization</span><br><span class="line">&#x2F;&#x2F;include &quot;&#x2F;etc&#x2F;bind&#x2F;zones.rfc1918&quot;;</span><br><span class="line">zone &quot;novalocal&quot; &#123;</span><br><span class="line">        type master;</span><br><span class="line">        file &quot;&#x2F;etc&#x2F;bind&#x2F;db.novalocal&quot;;</span><br><span class="line">&#125;;</span><br><span class="line"> </span><br><span class="line">root@origin-dns:&#x2F;etc&#x2F;bind# cat db.novalocal</span><br><span class="line">$TTL    604800</span><br><span class="line">@       IN      SOA     novalocal. root.novalocal. (</span><br><span class="line">                              1         ; Serial</span><br><span class="line">                         604800         ; Refresh</span><br><span class="line">                          86400         ; Retry</span><br><span class="line">                        2419200         ; Expire</span><br><span class="line">                          86400 )       ; Negative Cache TTL</span><br><span class="line">;</span><br><span class="line">@       IN      NS      novalocal.</span><br><span class="line">@       IN      A       192.168.10.143</span><br><span class="line">origin-master  IN      A       192.168.10.143</span><br><span class="line">origin-slave1  IN      A       192.168.10.149</span><br><span class="line">origin-slave2  IN      A       192.168.10.145</span><br><span class="line">origin-slave3  IN      A       192.168.10.147</span><br></pre></td></tr></table></figure>



<h3 id="OpenShift-Master节点配置"><a href="#OpenShift-Master节点配置" class="headerlink" title="OpenShift Master节点配置"></a>OpenShift Master节点配置</h3><p>1、ansible-openshift 的配置文件/etc/ansible/hosts 增加一下配置，完成OpenShift节点的定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[OSEv3:children]</span><br><span class="line">masters</span><br><span class="line">nodes</span><br><span class="line">[OSEv3:vars]</span><br><span class="line">ansible_ssh_user&#x3D;root</span><br><span class="line">deployment_type&#x3D;origin</span><br><span class="line">openshift\_master\_identity\_providers&#x3D;\[&#123;&#39;name&#39;: &#39;htpasswd\_auth&#39;, &#39;login&#39;: &#39;true&#39;, &#39;challenge&#39;: &#39;true&#39;, &#39;kind&#39;: &#39;HTPasswdPasswordIdentityProvider&#39;, &#39;filename&#39;: &#39;&#x2F;etc&#x2F;origin&#x2F;htpasswd&#39;&#125;\]</span><br><span class="line">os\_sdn\_network\_plugin\_name&#x3D;redhat&#x2F;openshift-ovs-multitenant</span><br><span class="line">openshift\_master\_portal\_net&#x3D;172.30.0.0&#x2F;16</span><br><span class="line">openshift\_master\_session\_name&#x3D;ssn</span><br><span class="line">openshift\_master\_session\_max\_seconds&#x3D;3600</span><br><span class="line">openshift\_master\_session\_auth\_secrets&#x3D;\[&#39;DONT+USE+THIS+SECRET+b4NV+pmZNSO&#39;\]</span><br><span class="line">openshift\_master\_session\_encryption\_secrets&#x3D;\[&#39;DONT+USE+THIS+SECRET+b4NV+pmZNSO&#39;\]</span><br><span class="line"> </span><br><span class="line">\[masters\]</span><br><span class="line">origin-master.novalocal openshift\_public\_ip&#x3D;10.110.17.139 openshift\_public\_hostname&#x3D;origin-master.novalocal</span><br><span class="line">\[nodes\]</span><br><span class="line">origin-slave1.novalocal openshift\_node\_labels&#x3D;&quot;&#123;&#39;region&#39;: &#39;primary&#39;, &#39;zone&#39;: &#39;east&#39;&#125;&quot;</span><br><span class="line">origin-slave2.novalocal openshift\_node\_labels&#x3D;&quot;&#123;&#39;region&#39;: &#39;primary&#39;, &#39;zone&#39;: &#39;east&#39;&#125;&quot;</span><br><span class="line">origin-slave3.novalocal openshift\_node\_labels&#x3D;&quot;&#123;&#39;region&#39;: &#39;primary&#39;, &#39;zone&#39;: &#39;east&#39;&#125;&quot;</span><br><span class="line">origin-master.novalocal openshift\_node\_labels&#x3D;&quot;&#123;&#39;region&#39;:&#39;infra&#39;,&#39;zone&#39;:&#39;default&#39;&#125;&quot; openshift\_schedulable&#x3D;false</span><br></pre></td></tr></table></figure>



<p>2、</p>
<p>搭建NFS服务器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">\[root@oc-master ~\]yum install nfs-utils</span><br><span class="line">\[root@oc-master ~\]cat &#x2F;etc&#x2F;exports</span><br><span class="line">&#x2F;opt&#x2F;docker-registry 192.168.10.0&#x2F;24(rw,sync,no\_root\_squash,no\_all\_squash)</span><br><span class="line">&#96;&#96;&#96;&#96; </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">配置服务端访问策略：</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;&#96;(python)</span><br><span class="line">cat  &#x2F;etc&#x2F;sysconfig&#x2F;iptables</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p udp -s 192.168.10.0&#x2F;24 --dport 111 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p tcp -s 192.168.10.0&#x2F;24 --dport 111 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p tcp -s 192.168.10.0&#x2F;24 --dport 20048 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p udp -s 192.168.6.0&#x2F;24 --dport 20048 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p udp -s 192.168.6.0&#x2F;24 --dport 2049 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p tcp -s 192.168.6.0&#x2F;24 --dport 2049 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p tcp -s 192.168.6.0&#x2F;24 --dport 20048 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p udp -s 192.168.6.0&#x2F;24 --dport 20048 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p udp -s 192.168.6.0&#x2F;24 --dport 49493 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p tcp -s 192.168.6.0&#x2F;24 --dport 49493 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p udp -s 192.168.6.0&#x2F;24 --dport 54932 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p tcp -s 192.168.6.0&#x2F;24 --dport 46120 -j ACCEPT</span><br><span class="line">-A OS\_FIREWALL\_ALLOW -m state --state NEW  -p udp -s 192.168.6.0&#x2F;24 --dport 37588 -j ACCEPT</span><br></pre></td></tr></table></figure>



<p>重启NFS服务 systemctl restart nfs-server.service</p>
<p>客户端挂载</p>
<p>mount -t nfs 192.168.6.7:/opt/docker-registry/ /opt/docker-registry/</p>
<h3 id="执行安装"><a href="#执行安装" class="headerlink" title="执行安装"></a>执行安装</h3><p>在master节点操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1、执行安装：ansible-playbook ~&#x2F;openshift-ansible&#x2F;playbooks&#x2F;byo&#x2F;config.yml</span><br></pre></td></tr></table></figure>

<p>2、执行卸载：ansible-playbook openshift-ansible/playbooks/adhoc/uninstall.yml</p>
<h3 id="部署Docker-Registry"><a href="#部署Docker-Registry" class="headerlink" title="部署Docker-Registry"></a>部署Docker-Registry</h3><p>Master节点配置nfs</p>
<p>注意：部署完成docker-registry后，不能再讲该服务进行删除，因为服务地址已经更新到etcd，该地址目前看来，无法实时更新</p>
<p>在master节点操作</p>
<p>oadm registry –config=/etc/origin/master/admin.kubeconfig  –credentials=/etc/origin/master/openshift-registry.kubeconfig –service-account=registry  –mount-host=/opt/docker-registry</p>
<h3 id="部署监控metrics"><a href="#部署监控metrics" class="headerlink" title="部署监控metrics"></a>部署监控metrics</h3><p>1 使用 openshift-infra工程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oc project openshift-infra</span><br></pre></td></tr></table></figure>
<p>2、</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oc secrets new metrics-deployer nothing&#x3D;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure>

<p>3、<br>oc process -f metrics-deployer.yaml -v HAWKULAR_METRICS_HOSTNAME=hawkular-metrics.devops.inspur,USE_PERSISTENT_STORAGE=false | oc create -f –</p>
<p>参考demo</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">#</span><br><span class="line"># Copyright 2014-2015 Red Hat, Inc. and&#x2F;or its affiliates</span><br><span class="line"># and other contributors as indicated by the @author tags.</span><br><span class="line">#</span><br><span class="line"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span><br><span class="line"># you may not use this file except in compliance with the License.</span><br><span class="line"># You may obtain a copy of the License at</span><br><span class="line">#</span><br><span class="line">#    http:&#x2F;&#x2F;www.apache.org&#x2F;licenses&#x2F;LICENSE-2.0</span><br><span class="line">#</span><br><span class="line"># Unless required by applicable law or agreed to in writing, software</span><br><span class="line"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span><br><span class="line"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span><br><span class="line"># See the License for the specific language governing permissions and</span><br><span class="line"># limitations under the License.</span><br><span class="line">#</span><br><span class="line"> </span><br><span class="line">apiVersion: &quot;v1&quot;</span><br><span class="line">kind: &quot;Template&quot;</span><br><span class="line">metadata:</span><br><span class="line">  name: metrics-deployer-template</span><br><span class="line">  annotations:</span><br><span class="line">    description: &quot;Template for deploying the required Metrics integration. Requires cluster-admin &#39;metrics-deployer&#39; service account and &#39;metrics-deployer&#39; secret.&quot;</span><br><span class="line">    tags: &quot;infrastructure&quot;</span><br><span class="line">labels:</span><br><span class="line">  metrics-infra: deployer</span><br><span class="line">  provider: openshift</span><br><span class="line">  component: deployer</span><br><span class="line">objects:</span><br><span class="line">-</span><br><span class="line">  apiVersion: v1</span><br><span class="line">  kind: Pod</span><br><span class="line">  metadata:</span><br><span class="line">    generateName: metrics-deployer-</span><br><span class="line">  spec:</span><br><span class="line">    containers:</span><br><span class="line">    - image: $&#123;IMAGE\_PREFIX&#125;metrics-deployer:$&#123;IMAGE\_VERSION&#125;</span><br><span class="line">      name: deployer</span><br><span class="line">      volumeMounts:</span><br><span class="line">      - name: secret</span><br><span class="line">        mountPath: &#x2F;secret</span><br><span class="line">        readOnly: true</span><br><span class="line">      - name: empty</span><br><span class="line">        mountPath: &#x2F;etc&#x2F;deploy</span><br><span class="line">      env:</span><br><span class="line">        - name: PROJECT</span><br><span class="line">          valueFrom:</span><br><span class="line">            fieldRef:</span><br><span class="line">              fieldPath: metadata.namespace</span><br><span class="line">        - name: IMAGE\_PREFIX</span><br><span class="line">          value: $&#123;IMAGE\_PREFIX&#125;</span><br><span class="line">        - name: IMAGE\_VERSION</span><br><span class="line">          value: $&#123;IMAGE\_VERSION&#125;</span><br><span class="line">        - name: MASTER\_URL</span><br><span class="line">          value: $&#123;MASTER\_URL&#125;</span><br><span class="line">        - name: REDEPLOY</span><br><span class="line">          value: $&#123;REDEPLOY&#125;</span><br><span class="line">        - name: USE\_PERSISTENT\_STORAGE</span><br><span class="line">          value: $&#123;USE\_PERSISTENT\_STORAGE&#125;</span><br><span class="line">        - name: HAWKULAR\_METRICS\_HOSTNAME</span><br><span class="line">          value: $&#123;HAWKULAR\_METRICS\_HOSTNAME&#125;</span><br><span class="line">        - name: CASSANDRA\_NODES</span><br><span class="line">          value: $&#123;CASSANDRA\_NODES&#125;</span><br><span class="line">        - name: CASSANDRA\_PV\_SIZE</span><br><span class="line">          value: $&#123;CASSANDRA\_PV\_SIZE&#125;</span><br><span class="line">        - name: METRIC\_DURATION</span><br><span class="line">          value: $&#123;METRIC\_DURATION&#125;</span><br><span class="line">    dnsPolicy: ClusterFirst</span><br><span class="line">    restartPolicy: Never</span><br><span class="line">    serviceAccount: metrics-deployer</span><br><span class="line">    volumes:</span><br><span class="line">    - name: empty</span><br><span class="line">      emptyDir: &#123;&#125;</span><br><span class="line">    - name: secret</span><br><span class="line">      secret:</span><br><span class="line">        secretName: metrics-deployer</span><br><span class="line">parameters:</span><br><span class="line">-</span><br><span class="line">  description: &#39;Specify prefix for metrics components; e.g. for &quot;openshift&#x2F;origin-metrics-deployer:latest&quot;, set prefix &quot;openshift&#x2F;origin-&quot;&#39;</span><br><span class="line">  name: IMAGE\_PREFIX</span><br><span class="line">  value: &quot;10.110.17.138:5000&#x2F;library&#x2F;origin-&quot;</span><br><span class="line">-</span><br><span class="line">  description: &#39;Specify version for metrics components; e.g. for &quot;openshift&#x2F;origin-metrics-deployer:latest&quot;, set version &quot;latest&quot;&#39;</span><br><span class="line">  name: IMAGE\_VERSION</span><br><span class="line">  value: &quot;latest&quot;</span><br><span class="line">-</span><br><span class="line">  description: &quot;Internal URL for the master, for authentication retrieval&quot;</span><br><span class="line">  name: MASTER\_URL</span><br><span class="line">  value: &quot;https:&#x2F;&#x2F;oc-master.novalocal:8443&quot;</span><br><span class="line">-</span><br><span class="line">  description: &quot;External hostname where clients will reach Hawkular Metrics&quot;</span><br><span class="line">  name: HAWKULAR\_METRICS\_HOSTNAME</span><br><span class="line">  required: true</span><br><span class="line">  value: &quot;hawkular-metrics.devops.inspur&quot;</span><br><span class="line">-</span><br><span class="line">  description: &quot;If set to true the deployer will try and delete all the existing components before trying to redeploy.&quot;</span><br><span class="line">  name: REDEPLOY</span><br><span class="line">  value: &quot;false&quot;</span><br><span class="line">-</span><br><span class="line">  description: &quot;Set to true for persistent storage, set to false to use non persistent storage&quot;</span><br><span class="line">  name: USE\_PERSISTENT\_STORAGE</span><br><span class="line">  value: &quot;false&quot;</span><br><span class="line">-</span><br><span class="line">  description: &quot;The number of Cassandra Nodes to deploy for the initial cluster&quot;</span><br><span class="line">  name: CASSANDRA\_NODES</span><br><span class="line">  value: &quot;1&quot;</span><br><span class="line">-</span><br><span class="line">  description: &quot;The persistent volume size for each of the Cassandra nodes&quot;</span><br><span class="line">  name: CASSANDRA\_PV\_SIZE</span><br><span class="line">  value: &quot;10Gi&quot;</span><br><span class="line">-</span><br><span class="line">  description: &quot;How many days metrics should be stored for.&quot;</span><br><span class="line">  name: METRIC\_DURATION</span><br><span class="line">  value: &quot;7&quot;</span><br></pre></td></tr></table></figure>



<p>当pod运行成功后，还需要修改/etc/origin/master/master-config.yaml文件，增加metric配置</p>
<p>通过浏览器访问控制台时，也会出现无法访问监控信息的情况，需要确认</p>
<p>（1） 浏览器能够解析hawkular-metrics.devops.inspur地址</p>
<p>（2） 使用浏览器访问改地址<a href="https://hawkular-metrics.devops.inspur/hawkular/metrics%EF%BC%8C%E5%8A%A0%E8%BD%BDhttps%E8%AF%81%E4%B9%A6" target="_blank" rel="noopener">https://hawkular-metrics.devops.inspur/hawkular/metrics，加载https证书</a></p>
<h3 id="部署Route"><a href="#部署Route" class="headerlink" title="部署Route"></a>部署Route</h3><p>在master节点操作</p>
<p>oadm router haproxy-router –replicas=1 –credentials=/etc/origin/master/openshift-router.kubeconfig –service-account=router</p>
<p>增加用户：htpasswd /etc/origin/htpasswd admin</p>
<p>普通用户登录;oc login</p>
<p>系统管理员登录：</p>
<p>export KUBECONFIG=/etc/origin/master/admin.kubeconfig</p>
<p>oc login -u system:admin -n default</p>
<p>此时，整个环境搭建完成，</p>
<h2 id="外部Docker-Registry搭建"><a href="#外部Docker-Registry搭建" class="headerlink" title="外部Docker-Registry搭建"></a>外部Docker-Registry搭建</h2><p>搭建一个V2版本的docker-registry</p>
<p>使用一台新的虚拟机，部署docker,部署docker registry</p>
<p>docker run -d -p 5000:5000 –name registry registry:2</p>
<p>注意：在该registry上传镜像时，需要制定子目录：例如例如10.110.17.138:5000/library/postgresql</p>
<h2 id="管理OpenShift"><a href="#管理OpenShift" class="headerlink" title="管理OpenShift"></a>管理OpenShift</h2><h3 id="导入镜像"><a href="#导入镜像" class="headerlink" title="导入镜像"></a>导入镜像</h3><p>导入的镜像都存放到了 openshift的内部镜像</p>
<h4 id="1、从第三方仓库导入镜像"><a href="#1、从第三方仓库导入镜像" class="headerlink" title="1、从第三方仓库导入镜像"></a>1、从第三方仓库导入镜像</h4><p>从第三方仓库导入的镜像，只是在OpenShift的内部镜像仓库中，保存了索引信息，真正使用的时候，还是要去第三方仓库下载，将外部镜像导入到OpenShift，可以指定命名空间进行导入</p>
<p>进行导入：oc create <strong>-**f image-streams-centos7-python-postgresql</strong>.**json **-**n demo</p>
<p>导入镜像使用的文件参考参考image-streams-centos7-python-postgresql.json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;kind&quot;: &quot;ImageStreamList&quot;,</span><br><span class="line">  &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">  &quot;items&quot;: \[</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;kind&quot;: &quot;ImageStream&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">          &quot;name&quot;: &quot;python&quot;,</span><br><span class="line">          &quot;annotations&quot;: &#123;</span><br><span class="line">               &quot;openshift.io&#x2F;image.insecureRepository&quot;: &quot;true&quot;</span><br><span class="line">             &#125;</span><br><span class="line">       &#125;,</span><br><span class="line">      &quot;spec&quot;: &#123;</span><br><span class="line">         &quot;dockerImageRepository&quot;: &quot;10.110.17.138:5000&#x2F;library&#x2F;python&quot;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;kind&quot;: &quot;ImageStream&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">       &quot;metadata&quot;: &#123;</span><br><span class="line">           &quot;name&quot;: &quot;postgresql&quot;,</span><br><span class="line">           &quot;annotations&quot;: &#123;</span><br><span class="line">               &quot;openshift.io&#x2F;image.insecureRepository&quot;: &quot;true&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">       &quot;spec&quot;: &#123;</span><br><span class="line">          &quot;dockerImageRepository&quot;: &quot;10.110.17.138:5000&#x2F;library&#x2F;postgresql&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;\]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>注意：外部的私有docker-registry 的镜像存储目录必须有子目录：例如10.110.17.138:5000/library/postgresql</p>
<h4 id="2、登录OpenShift-内部docker-registry，导入镜像"><a href="#2、登录OpenShift-内部docker-registry，导入镜像" class="headerlink" title="2、登录OpenShift 内部docker-registry，导入镜像"></a>2、登录OpenShift 内部docker-registry，导入镜像</h4><p>  1、在master节点获取，docker-registry服务的service ip</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> \[root@origin-master image-streams\]# oc get svc</span><br><span class="line">NAME              CLUSTER\_IP      EXTERNAL\_IP   PORT(S)                 SELECTOR                  AGE</span><br><span class="line">docker-registry   172.30.90.102   &lt;none&gt;        5000&#x2F;TCP                docker-registry&#x3D;default   20h</span><br><span class="line">haproxy-router    172.30.95.6     &lt;none&gt;        80&#x2F;TCP                  router&#x3D;haproxy-router     20h</span><br><span class="line">kubernetes        172.30.0.1      &lt;none&gt;        443&#x2F;TCP,53&#x2F;UDP,53&#x2F;TCP   &lt;none&gt;                    22h</span><br></pre></td></tr></table></figure>



<p>2、查看OpenShift内部docker-registry所在的节点，并登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  root@origin-slave3 ~\]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE                                                                                                           COMMAND                  CREATED             STATUS              PORTS               NAMES</span><br><span class="line">40a2a7f9c5f0        openshift&#x2F;origin-docker-registry:v1.1.0.1                                                                       &quot;&#x2F;bin&#x2F;sh -c &#39;REGISTRY&quot;   5 hours ago         Up 5 hours                              k8s\_registry.afeb0b36\_docker-registry-1-2wsvm\_default\_fa5e59e4-af5a-11e5-8632-fa163efe8294\_4fbf4ffa</span><br><span class="line">b29287d1a00c        10.110.17.138:5000&#x2F;library&#x2F;postgresql@sha256:11dbc16d7d84da0dfb42782ff1f64b0e263d9f8686fe4347f2d02a665582e945   &quot;container-entrypoint&quot;   5 hours ago         Up 5 hours                              k8s\_postgresql.5134f420\_postgresql-1-eun94\_demo\_7e990eb5-af62-11e5-8632-fa163efe8294\_155dadb8</span><br><span class="line">c217ccc5c319        openshift&#x2F;origin-pod:v1.1.0.1                                                                                   &quot;&#x2F;pod&quot;                   5 hours ago         Up 5 hours                              k8s\_POD.18d9fe1e\_postgresql-1-eun94\_demo\_7e990eb5-af62-11e5-8632-fa163efe8294\_257ba619</span><br><span class="line">bbc34e05ca92        openshift&#x2F;origin-pod:v1.1.0.1                                                                                   &quot;&#x2F;pod&quot;                   5 hours ago         Up 5 hours                              k8s\_POD.7c1fe15\_docker-registry-1-2wsvm\_default\_fa5e59e4-af5a-11e5-8632-fa163efe8294\_7a1bd148</span><br></pre></td></tr></table></figure>



<p>3、 以普通用户登录openshift，获取tocker</p>
<p><strong>[**root@origin</strong>-<strong>slave</strong>3** ~**]**# oc whoami **-**t</p>
<p>YAiqVCwCIhMT6FoVXfhpnga4UBiud0Mwzz84-sW3Om8</p>
<p>4、</p>
<p><strong>[**root@origin</strong>-<strong>slave</strong>3** ~<strong>]**# docker login **-**u admin **-**e admin@inspur</strong>.<strong>com **-**p YAiqVCwCIhMT6FoVXfhpnga4UBiud0Mwzz84-sW3Om8 **172.30.90.102:5000</strong></p>
<p>WARNING**:** login credentials saved in <strong>/**root</strong>/.<strong>docker</strong>/config.**json</p>
<p>Login Succeeded</p>
<p>5、 上传镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">\[root@origin-slave3 ~\]# docker tag 10.110.17.138:5000&#x2F;library&#x2F;hello-openshift 172.30.90.102:5000&#x2F;demo&#x2F;hello-openshift</span><br><span class="line">\[root@origin-slave3 ~\]# docker push 172.30.90.102:5000&#x2F;demo&#x2F;hello-openshift</span><br><span class="line">The push refers to a repository \[172.30.90.102:5000&#x2F;demo&#x2F;hello-openshift\] (len: 1)</span><br><span class="line">bcfa6006862b: Pushed</span><br><span class="line">bbc202431232: Pushed</span><br><span class="line">eb19dbec24c6: Pushed</span><br><span class="line">0055f04883dd: Pushed</span><br><span class="line">latest: digest: sha256:724411548d3c1ea88402288b2045275cd3fd0488f6d6500f4f6974b278f27f39 size: 6982</span><br></pre></td></tr></table></figure>

<h3 id="部署Template"><a href="#部署Template" class="headerlink" title="部署Template"></a>部署Template</h3><p>Template定义了一套部署应用的完成流程，包含打包、发布等，供开发者使用</p>
<p>部署template</p>
<p>oc create-f django-postgres.json -n openshif</p>
<p>Template 参考文件django-postgres.json，特别注意镜像的使用方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;kind&quot;: &quot;Template&quot;,</span><br><span class="line">  &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">  &quot;metadata&quot;: &#123;</span><br><span class="line">    &quot;name&quot;: &quot;django-psql-example&quot;,</span><br><span class="line">    &quot;annotations&quot;: &#123;</span><br><span class="line">      &quot;description&quot;: &quot;An example Django application with a PostgreSQL database&quot;,</span><br><span class="line">      &quot;tags&quot;: &quot;instant-app,python,django,postgresql&quot;,</span><br><span class="line">      &quot;iconClass&quot;: &quot;icon-python&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;labels&quot;: &#123;</span><br><span class="line">    &quot;template&quot;: &quot;django-psql-example&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;objects&quot;: \[</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;kind&quot;: &quot;Service&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;django-psql-example&quot;,</span><br><span class="line">        &quot;annotations&quot;: &#123;</span><br><span class="line">          &quot;description&quot;: &quot;Exposes and load balances the application pods&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;spec&quot;: &#123;</span><br><span class="line">        &quot;ports&quot;: \[</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;name&quot;: &quot;web&quot;,</span><br><span class="line">            &quot;port&quot;: 8080,</span><br><span class="line">            &quot;targetPort&quot;: 8080</span><br><span class="line">          &#125;</span><br><span class="line">        \],</span><br><span class="line">        &quot;selector&quot;: &#123;</span><br><span class="line">          &quot;name&quot;: &quot;django-psql-example&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;kind&quot;: &quot;Route&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;django-psql-example&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;spec&quot;: &#123;</span><br><span class="line">        &quot;host&quot;: &quot;$&#123;APPLICATION\_DOMAIN&#125;&quot;,</span><br><span class="line">        &quot;to&quot;: &#123;</span><br><span class="line">          &quot;kind&quot;: &quot;Service&quot;,</span><br><span class="line">          &quot;name&quot;: &quot;django-psql-example&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;kind&quot;: &quot;ImageStream&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;django-psql-example&quot;,</span><br><span class="line">        &quot;annotations&quot;: &#123;</span><br><span class="line">          &quot;description&quot;: &quot;Keeps track of changes in the application image&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;kind&quot;: &quot;BuildConfig&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;django-psql-example&quot;,</span><br><span class="line">        &quot;annotations&quot;: &#123;</span><br><span class="line">          &quot;description&quot;: &quot;Defines how to build the application&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;spec&quot;: &#123;</span><br><span class="line">        &quot;source&quot;: &#123;</span><br><span class="line">          &quot;type&quot;: &quot;Git&quot;,</span><br><span class="line">          &quot;git&quot;: &#123;</span><br><span class="line">            &quot;uri&quot;: &quot;$&#123;SOURCE\_REPOSITORY\_URL&#125;&quot;,</span><br><span class="line">            &quot;ref&quot;: &quot;$&#123;SOURCE\_REPOSITORY\_REF&#125;&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;contextDir&quot;: &quot;$&#123;CONTEXT\_DIR&#125;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;strategy&quot;: &#123;</span><br><span class="line">          &quot;type&quot;: &quot;Source&quot;,</span><br><span class="line">          &quot;sourceStrategy&quot;: &#123;</span><br><span class="line">            &quot;from&quot;: &#123;</span><br><span class="line">              &quot;kind&quot;: &quot;ImageStreamTag&quot;,</span><br><span class="line">              &quot;namespace&quot;: &quot;openshift&quot;,</span><br><span class="line">              &quot;name&quot;: &quot;python&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;output&quot;: &#123;</span><br><span class="line">          &quot;to&quot;: &#123;</span><br><span class="line">            &quot;kind&quot;: &quot;ImageStreamTag&quot;,</span><br><span class="line">            &quot;name&quot;: &quot;django-psql-example:latest&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;triggers&quot;: \[</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;type&quot;: &quot;ImageChange&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;type&quot;: &quot;ConfigChange&quot;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;type&quot;: &quot;GitHub&quot;,</span><br><span class="line">            &quot;github&quot;: &#123;</span><br><span class="line">              &quot;secret&quot;: &quot;$&#123;GITHUB\_WEBHOOK\_SECRET&#125;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        \]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;kind&quot;: &quot;DeploymentConfig&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;django-psql-example&quot;,</span><br><span class="line">        &quot;annotations&quot;: &#123;</span><br><span class="line">          &quot;description&quot;: &quot;Defines how to deploy the application server&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;spec&quot;: &#123;</span><br><span class="line">        &quot;strategy&quot;: &#123;</span><br><span class="line">          &quot;type&quot;: &quot;Rolling&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;triggers&quot;: \[</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;type&quot;: &quot;ImageChange&quot;,</span><br><span class="line">            &quot;imageChangeParams&quot;: &#123;</span><br><span class="line">              &quot;automatic&quot;: true,</span><br><span class="line">              &quot;containerNames&quot;: \[</span><br><span class="line">                &quot;django-psql-example&quot;</span><br><span class="line">              \],</span><br><span class="line">              &quot;from&quot;: &#123;</span><br><span class="line">                &quot;kind&quot;: &quot;ImageStreamTag&quot;,</span><br><span class="line">                &quot;name&quot;: &quot;django-psql-example:latest&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;type&quot;: &quot;ConfigChange&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        \],</span><br><span class="line">        &quot;replicas&quot;: 1,</span><br><span class="line">        &quot;selector&quot;: &#123;</span><br><span class="line">          &quot;name&quot;: &quot;django-psql-example&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;template&quot;: &#123;</span><br><span class="line">          &quot;metadata&quot;: &#123;</span><br><span class="line">            &quot;name&quot;: &quot;django-psql-example&quot;,</span><br><span class="line">            &quot;labels&quot;: &#123;</span><br><span class="line">              &quot;name&quot;: &quot;django-psql-example&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;spec&quot;: &#123;</span><br><span class="line">            &quot;containers&quot;: \[</span><br><span class="line">              &#123;</span><br><span class="line">                &quot;name&quot;: &quot;django-psql-example&quot;,</span><br><span class="line">                &quot;image&quot;: &quot;django-psql-example&quot;,</span><br><span class="line">                &quot;ports&quot;: \[</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;containerPort&quot;: 8080</span><br><span class="line">                  &#125;</span><br><span class="line">                \],</span><br><span class="line">                &quot;env&quot;: \[</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;DATABASE\_SERVICE\_NAME&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;DATABASE\_SERVICE\_NAME&#125;&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;DATABASE\_ENGINE&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;DATABASE\_ENGINE&#125;&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;DATABASE\_NAME&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;DATABASE\_NAME&#125;&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;DATABASE\_USER&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;DATABASE\_USER&#125;&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;DATABASE\_PASSWORD&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;DATABASE\_PASSWORD&#125;&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;APP\_CONFIG&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;APP\_CONFIG&#125;&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;DJANGO\_SECRET\_KEY&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;DJANGO\_SECRET\_KEY&#125;&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                \]</span><br><span class="line">              &#125;</span><br><span class="line">            \]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;kind&quot;: &quot;Service&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;$&#123;DATABASE\_SERVICE\_NAME&#125;&quot;,</span><br><span class="line">        &quot;annotations&quot;: &#123;</span><br><span class="line">          &quot;description&quot;: &quot;Exposes the database server&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;spec&quot;: &#123;</span><br><span class="line">        &quot;ports&quot;: \[</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;name&quot;: &quot;postgresql&quot;,</span><br><span class="line">            &quot;port&quot;: 5432,</span><br><span class="line">            &quot;targetPort&quot;: 5432</span><br><span class="line">          &#125;</span><br><span class="line">        \],</span><br><span class="line">        &quot;selector&quot;: &#123;</span><br><span class="line">          &quot;name&quot;: &quot;$&#123;DATABASE\_SERVICE\_NAME&#125;&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;kind&quot;: &quot;DeploymentConfig&quot;,</span><br><span class="line">      &quot;apiVersion&quot;: &quot;v1&quot;,</span><br><span class="line">      &quot;metadata&quot;: &#123;</span><br><span class="line">        &quot;name&quot;: &quot;$&#123;DATABASE\_SERVICE\_NAME&#125;&quot;,</span><br><span class="line">        &quot;annotations&quot;: &#123;</span><br><span class="line">          &quot;description&quot;: &quot;Defines how to deploy the database&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;spec&quot;: &#123;</span><br><span class="line">        &quot;strategy&quot;: &#123;</span><br><span class="line">          &quot;type&quot;: &quot;Recreate&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;triggers&quot;: \[</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;type&quot;: &quot;ImageChange&quot;,</span><br><span class="line">            &quot;imageChangeParams&quot;: &#123;</span><br><span class="line">              &quot;automatic&quot;: false,</span><br><span class="line">              &quot;containerNames&quot;: \[</span><br><span class="line">                &quot;postgresql&quot;</span><br><span class="line">              \],</span><br><span class="line">              &quot;from&quot;: &#123;</span><br><span class="line">                &quot;kind&quot;: &quot;ImageStreamTag&quot;,</span><br><span class="line">                &quot;namespace&quot;: &quot;openshift&quot;,</span><br><span class="line">                &quot;name&quot;: &quot;postgresql&quot;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;type&quot;: &quot;ConfigChange&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        \],</span><br><span class="line">        &quot;replicas&quot;: 1,</span><br><span class="line">        &quot;selector&quot;: &#123;</span><br><span class="line">          &quot;name&quot;: &quot;$&#123;DATABASE\_SERVICE\_NAME&#125;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;template&quot;: &#123;</span><br><span class="line">          &quot;metadata&quot;: &#123;</span><br><span class="line">            &quot;name&quot;: &quot;$&#123;DATABASE\_SERVICE\_NAME&#125;&quot;,</span><br><span class="line">            &quot;labels&quot;: &#123;</span><br><span class="line">              &quot;name&quot;: &quot;$&#123;DATABASE\_SERVICE\_NAME&#125;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &quot;spec&quot;: &#123;</span><br><span class="line">            &quot;containers&quot;: \[</span><br><span class="line">              &#123;</span><br><span class="line">                &quot;name&quot;: &quot;postgresql&quot;,</span><br><span class="line">                &quot;image&quot;: &quot;postgresql&quot;,</span><br><span class="line">                &quot;ports&quot;: \[</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;containerPort&quot;: 5432</span><br><span class="line">                  &#125;</span><br><span class="line">                \],</span><br><span class="line">                &quot;env&quot;: \[</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;POSTGRESQL\_USER&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;DATABASE\_USER&#125;&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;POSTGRESQL\_PASSWORD&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;DATABASE\_PASSWORD&#125;&quot;</span><br><span class="line">                  &#125;,</span><br><span class="line">                  &#123;</span><br><span class="line">                    &quot;name&quot;: &quot;POSTGRESQL\_DATABASE&quot;,</span><br><span class="line">                    &quot;value&quot;: &quot;$&#123;DATABASE\_NAME&#125;&quot;</span><br><span class="line">                  &#125;</span><br><span class="line">                \]</span><br><span class="line">              &#125;</span><br><span class="line">            \]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  \],</span><br><span class="line">  &quot;parameters&quot;: \[</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;SOURCE\_REPOSITORY\_URL&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;The URL of the repository with your application source code&quot;,</span><br><span class="line">      &quot;value&quot;: &quot;https:&#x2F;&#x2F;github.com&#x2F;openshift&#x2F;django-ex.git&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;SOURCE\_REPOSITORY\_REF&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Set this to a branch name, tag or other ref of your repository if you are not using the default branch&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;CONTEXT\_DIR&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Set this to the relative path to your project if it is not in the root of your repository&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;APPLICATION\_DOMAIN&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;The exposed hostname that will route to the Django service, if left blank a value will be defaulted.&quot;,</span><br><span class="line">      &quot;value&quot;: &quot;&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;GITHUB\_WEBHOOK\_SECRET&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;A secret string used to configure the GitHub webhook&quot;,</span><br><span class="line">      &quot;generate&quot;: &quot;expression&quot;,</span><br><span class="line">      &quot;from&quot;: &quot;\[a-zA-Z0-9\]&#123;40&#125;&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;DATABASE\_SERVICE\_NAME&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Database service name&quot;,</span><br><span class="line">      &quot;value&quot;: &quot;postgresql&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;DATABASE\_ENGINE&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Database engine: postgresql, mysql or sqlite (default)&quot;,</span><br><span class="line">      &quot;value&quot;: &quot;postgresql&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;DATABASE\_NAME&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Database name&quot;,</span><br><span class="line">      &quot;value&quot;: &quot;default&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;DATABASE\_USER&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Database user name&quot;,</span><br><span class="line">      &quot;value&quot;: &quot;django&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;DATABASE\_PASSWORD&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Database user password&quot;,</span><br><span class="line">      &quot;generate&quot;: &quot;expression&quot;,</span><br><span class="line">      &quot;from&quot;: &quot;\[a-zA-Z0-9\]&#123;16&#125;&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;APP\_CONFIG&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Relative path to Gunicorn configuration file (optional)&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;name&quot;: &quot;DJANGO\_SECRET\_KEY&quot;,</span><br><span class="line">      &quot;description&quot;: &quot;Set this to a long random string&quot;,</span><br><span class="line">      &quot;generate&quot;: &quot;expression&quot;,</span><br><span class="line">      &quot;from&quot;: &quot;\[\\\\w\]&#123;50&#125;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  \]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>应用管理：</p>
<p>创建应用：基于源码（首先将源码build成镜像），基于镜像，基于模板</p>
<p>基于源码创建：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">oc new-app myproject&#x2F;my-ruby~https:&#x2F;&#x2F;github.com&#x2F;openshift&#x2F;ruby-hello-world.git （failed）</span><br><span class="line"> oc new-app &#x2F;home&#x2F;user&#x2F;code&#x2F;myapp --strategy&#x3D;docker</span><br></pre></td></tr></table></figure>
<p>基于镜像创建：</p>
<p>使用本地镜像创建：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oc new-app 10.110.17.138:5000&#x2F;centos  --insecure-registry&#x3D;true</span><br></pre></td></tr></table></figure>
<p>ImageStreamTag</p>
<h3 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h3><p>文件定义一个部署，例如，可以使用内部的镜像，也可以使用外部的镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: ReplicationController</span><br><span class="line">metadata:</span><br><span class="line">  name: frontend-1</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  selector:</span><br><span class="line">    name: frontend</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        name: frontend</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - image: 172.30.90.102:5000&#x2F;demo&#x2F;hello-openshift</span><br><span class="line">        name: helloworld</span><br><span class="line">        ports:</span><br><span class="line">        - containerPort: 8080</span><br><span class="line">          protocol: TCP</span><br><span class="line">      restartPolicy: Always</span><br></pre></td></tr></table></figure>

<h3 id="持久化存储-PersistentVolume"><a href="#持久化存储-PersistentVolume" class="headerlink" title="持久化存储 PersistentVolume "></a>持久化存储 PersistentVolume </h3><p>搭建NFS服务器，只支持NFSV4</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">**\[**root@oc**\-**master example**\]**\# cat **&#x2F;**etc**&#x2F;**exports</span><br><span class="line"></span><br><span class="line">**&#x2F;**opt**&#x2F;**docker-registry **192.168.6.0&#x2F;**24**(**rw**,**sync**,**no\_root\_squash**,**no\_all\_squash**)**</span><br><span class="line"></span><br><span class="line">**&#x2F;**openshift-pv **\*(**rw**,**all\_squash**)**</span><br><span class="line"></span><br><span class="line">**\[**root@oc**\-**master example**\]**\# mkdir **&#x2F;**openshift-pv</span><br><span class="line"></span><br><span class="line">**\[**root@oc**\-**master example**\]**\# chown **\-**R nfsnobody**:**nfsnobody &#x2F;openshift-pv</span><br><span class="line"></span><br><span class="line">**\[**root@oc**\-**master example**\]**\# chmod **777** **&#x2F;**opt**&#x2F;**openshift-pv**&#x2F;**</span><br></pre></td></tr></table></figure>

<p>创建PV:persistentvolume</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">**&#123;**</span><br><span class="line"></span><br><span class="line">  &quot;apiVersion&quot;**:** &quot;v1&quot;**,**</span><br><span class="line"></span><br><span class="line">  &quot;kind&quot;**:** &quot;PersistentVolume&quot;**,**</span><br><span class="line"></span><br><span class="line">  &quot;metadata&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">    &quot;name&quot;**:** &quot;jenkins&quot;</span><br><span class="line"></span><br><span class="line">  **&#125;,**</span><br><span class="line"></span><br><span class="line">  &quot;spec&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">    &quot;capacity&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;storage&quot;**:** &quot;5Gi&quot;</span><br><span class="line"></span><br><span class="line">    **&#125;,**</span><br><span class="line"></span><br><span class="line">    &quot;accessModes&quot;**: \[** &quot;ReadWriteOnce&quot; **\],**</span><br><span class="line"></span><br><span class="line">    &quot;nfs&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;path&quot;**:** &quot;&#x2F;openshit-pv&quot;**,**</span><br><span class="line"></span><br><span class="line">        &quot;server&quot;**:** &quot;192.168.6.7&quot;</span><br><span class="line"></span><br><span class="line">    **&#125;,**</span><br><span class="line"></span><br><span class="line">    &quot;persistentVolumeReclaimPolicy&quot;**:** &quot;Recycle&quot;</span><br><span class="line"></span><br><span class="line">  **&#125;**</span><br><span class="line"></span><br><span class="line">**&#125;**</span><br></pre></td></tr></table></figure>
<p>举例：jenkins使用创建的PV</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br></pre></td><td class="code"><pre><span class="line">**&#123;**</span><br><span class="line"></span><br><span class="line">  &quot;kind&quot;**:** &quot;Template&quot;**,**</span><br><span class="line"></span><br><span class="line">  &quot;apiVersion&quot;**:** &quot;v1&quot;**,**</span><br><span class="line"></span><br><span class="line">  &quot;metadata&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">    &quot;name&quot;**:** &quot;jenkins-persistent&quot;**,**</span><br><span class="line"></span><br><span class="line">    &quot;creationTimestamp&quot;**:** null**,**</span><br><span class="line"></span><br><span class="line">    &quot;annotations&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">      &quot;description&quot;**:** &quot;Jenkins service, with persistent storage.&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;iconClass&quot;**:** &quot;icon-jenkins&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;tags&quot;**:** &quot;instant-app,jenkins&quot;</span><br><span class="line"></span><br><span class="line">    **&#125;**</span><br><span class="line"></span><br><span class="line">  **&#125;,**</span><br><span class="line"></span><br><span class="line">  &quot;objects&quot;**: \[**</span><br><span class="line"></span><br><span class="line">    **&#123;**</span><br><span class="line"></span><br><span class="line">      &quot;kind&quot;**:** &quot;Service&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;apiVersion&quot;**:** &quot;v1&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;metadata&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;name&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;&quot;**,**</span><br><span class="line"></span><br><span class="line">        &quot;creationTimestamp&quot;**:** null</span><br><span class="line"></span><br><span class="line">      **&#125;,**</span><br><span class="line"></span><br><span class="line">      &quot;spec&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;ports&quot;**: \[**</span><br><span class="line"></span><br><span class="line">          **&#123;**</span><br><span class="line"></span><br><span class="line">            &quot;name&quot;**:** &quot;web&quot;**,**</span><br><span class="line"></span><br><span class="line">            &quot;protocol&quot;**:** &quot;TCP&quot;**,**</span><br><span class="line"></span><br><span class="line">            &quot;port&quot;**:** **8080,**</span><br><span class="line"></span><br><span class="line">            &quot;targetPort&quot;**:** **8080,**</span><br><span class="line"></span><br><span class="line">            &quot;nodePort&quot;**:** **0**</span><br><span class="line"></span><br><span class="line">          **&#125;**</span><br><span class="line"></span><br><span class="line">        **\],**</span><br><span class="line"></span><br><span class="line">        &quot;selector&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">          &quot;name&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;&quot;</span><br><span class="line"></span><br><span class="line">        **&#125;,**</span><br><span class="line"></span><br><span class="line">        &quot;portalIP&quot;**:** &quot;&quot;**,**</span><br><span class="line"></span><br><span class="line">        &quot;type&quot;**:** &quot;ClusterIP&quot;**,**</span><br><span class="line"></span><br><span class="line">        &quot;sessionAffinity&quot;**:** &quot;None&quot;</span><br><span class="line"></span><br><span class="line">      **&#125;**</span><br><span class="line"></span><br><span class="line">    **&#125;,**</span><br><span class="line"></span><br><span class="line">    **&#123;**</span><br><span class="line"></span><br><span class="line">      &quot;kind&quot;**:** &quot;Route&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;apiVersion&quot;**:** &quot;v1&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;metadata&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;name&quot;**:** &quot;jenkins&quot;**,**</span><br><span class="line"></span><br><span class="line">        &quot;creationTimestamp&quot;**:** null</span><br><span class="line"></span><br><span class="line">      **&#125;,**</span><br><span class="line"></span><br><span class="line">      &quot;spec&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;to&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">          &quot;kind&quot;**:** &quot;Service&quot;**,**</span><br><span class="line"></span><br><span class="line">          &quot;name&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;&quot;</span><br><span class="line"></span><br><span class="line">        **&#125;,**</span><br><span class="line"></span><br><span class="line">        &quot;tls&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">          &quot;termination&quot;**:** &quot;edge&quot;**,**</span><br><span class="line"></span><br><span class="line">          &quot;certificate&quot;**:** &quot;-----BEGIN CERTIFICATE-----**\\n**MIIDIjCCAgqgAwIBAgIBATANBgkqhkiG9w0BAQUFADCBoTELMAkGA1UEBhMCVVMx**\\n**CzAJBgNVBAgMAlNDMRUwEwYDVQQHDAxEZWZhdWx0IENpdHkxHDAaBgNVBAoME0Rl**\\n**ZmF1bHQgQ29tcGFueSBMdGQxEDAOBgNVBAsMB1Rlc3QgQ0ExGjAYBgNVBAMMEXd3**\\n**dy5leGFtcGxlY2EuY29tMSIwIAYJKoZIhvcNAQkBFhNleGFtcGxlQGV4YW1wbGUu**\\n**Y29tMB4XDTE1MDExMjE0MTk0MVoXDTE2MDExMjE0MTk0MVowfDEYMBYGA1UEAwwP**\\n**d3d3LmV4YW1wbGUuY29tMQswCQYDVQQIDAJTQzELMAkGA1UEBhMCVVMxIjAgBgkq**\\n**hkiG9w0BCQEWE2V4YW1wbGVAZXhhbXBsZS5jb20xEDAOBgNVBAoMB0V4YW1wbGUx**\\n**EDAOBgNVBAsMB0V4YW1wbGUwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMrv**\\n**gu6ZTTefNN7jjiZbS&#x2F;xvQjyXjYMN7oVXv76jbX8gjMOmg9m0xoVZZFAE4XyQDuCm**\\n**47VRx5Qrf&#x2F;YLXmB2VtCFvB0AhXr5zSeWzPwaAPrjA4ebG+LUo24ziS8KqNxrFs1M**\\n**mNrQUgZyQC6XIe1JHXc9t+JlL5UZyZQC1IfaJulDAgMBAAGjDTALMAkGA1UdEwQC**\\n**MAAwDQYJKoZIhvcNAQEFBQADggEBAFCi7ZlkMnESvzlZCvv82Pq6S46AAOTPXdFd**\\n**TMvrh12E1sdVALF1P1oYFJzG1EiZ5ezOx88fEDTW+Lxb9anw5&#x2F;KJzwtWcfsupf1m**\\n**V7J0D3qKzw5C1wjzYHh9&#x2F;Pz7B1D0KthQRATQCfNf8s6bbFLaw&#x2F;dmiIUhHLtIH5Qc**\\n**yfrejTZbOSP77z8NOWir+BWWgIDDB2&#x2F;&#x2F;3AkDIQvT20vmkZRhkqSdT7et4NmXOX&#x2F;j**\\n**jhPti4b2Fie0LeuvgaOdKjCpQQNrYthZHXeVlOLRhMTSk3qUczenkKTOhvP7IS9q**\\n**+Dzv5hqgSfvMG392KWh5f8xXfJNs4W5KLbZyl901MeReiLrPH3w&#x3D;**\\n**\-----END CERTIFICATE-----&quot;**,**</span><br><span class="line"></span><br><span class="line">          &quot;key&quot;**:** &quot;-----BEGIN PRIVATE KEY-----**\\n**MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBAMrvgu6ZTTefNN7j**\\n**jiZbS&#x2F;xvQjyXjYMN7oVXv76jbX8gjMOmg9m0xoVZZFAE4XyQDuCm47VRx5Qrf&#x2F;YL**\\n**XmB2VtCFvB0AhXr5zSeWzPwaAPrjA4ebG+LUo24ziS8KqNxrFs1MmNrQUgZyQC6X**\\n**Ie1JHXc9t+JlL5UZyZQC1IfaJulDAgMBAAECgYEAnxOjEj&#x2F;vrLNLMZE1Q9H7PZVF**\\n**WdP&#x2F;JQVNvQ7tCpZ3ZdjxHwkvf&#x2F;&#x2F;aQnuxS5yX2Rnf37BS&#x2F;TZu+TIkK4373CfHomSx**\\n**UTAn2FsLmOJljupgGcoeLx5K5nu7B7rY5L1NHvdpxZ4YjeISrRtEPvRakllENU5y**\\n**gJE8c2eQOx08ZSRE4TkCQQD7dws2&#x2F;FldqwdjJucYijsJVuUdoTqxP8gWL6bB251q**\\n**elP2&#x2F;a6W2elqOcWId28560jG9ZS3cuKvnmu&#x2F;4LG88vZFAkEAzphrH3673oTsHN+d**\\n**uBd5uyrlnGjWjuiMKv2TPITZcWBjB8nJDSvLneHF59MYwejNNEof2tRjgFSdImFH**\\n**mi995wJBAMtPjW6wiqRz0i41VuT9ZgwACJBzOdvzQJfHgSD9qgFb1CU&#x2F;J&#x2F;hpSRIM**\\n**kYvrXK9MbvQFvG6x4VuyT1W8mpe1LK0CQAo8VPpffhFdRpF7psXLK&#x2F;XQ&#x2F;0VLkG3O**\\n**KburipLyBg&#x2F;u9ZkaL0Ley5zL5dFBjTV2Qkx367Ic2b0u9AYTCcgi2DsCQQD3zZ7B**\\n**v7BOm7MkylKokY2MduFFXU0Bxg6pfZ7q3rvg8gqhUFbaMStPRYg6myiDiW&#x2F;JfLhF**\\n**TcFT4touIo7oriFJ**\\n**\-----END PRIVATE KEY-----&quot;**,**</span><br><span class="line"></span><br><span class="line">          &quot;caCertificate&quot;**:** &quot;-----BEGIN CERTIFICATE-----**\\n**MIIEFzCCAv+gAwIBAgIJALK1iUpF2VQLMA0GCSqGSIb3DQEBBQUAMIGhMQswCQYD**\\n**VQQGEwJVUzELMAkGA1UECAwCU0MxFTATBgNVBAcMDERlZmF1bHQgQ2l0eTEcMBoG**\\n**A1UECgwTRGVmYXVsdCBDb21wYW55IEx0ZDEQMA4GA1UECwwHVGVzdCBDQTEaMBgG**\\n**A1UEAwwRd3d3LmV4YW1wbGVjYS5jb20xIjAgBgkqhkiG9w0BCQEWE2V4YW1wbGVA**\\n**ZXhhbXBsZS5jb20wHhcNMTUwMTEyMTQxNTAxWhcNMjUwMTA5MTQxNTAxWjCBoTEL**\\n**MAkGA1UEBhMCVVMxCzAJBgNVBAgMAlNDMRUwEwYDVQQHDAxEZWZhdWx0IENpdHkx**\\n**HDAaBgNVBAoME0RlZmF1bHQgQ29tcGFueSBMdGQxEDAOBgNVBAsMB1Rlc3QgQ0Ex**\\n**GjAYBgNVBAMMEXd3dy5leGFtcGxlY2EuY29tMSIwIAYJKoZIhvcNAQkBFhNleGFt**\\n**cGxlQGV4YW1wbGUuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA**\\n**w2rK1J2NMtQj0KDug7g7HRKl5jbf0QMkMKyTU1fBtZ0cCzvsF4CqV11LK4BSVWaK**\\n**rzkaXe99IVJnH8KdOlDl5Dh&#x2F;+cJ3xdkClSyeUT4zgb6CCBqg78ePp+nN11JKuJlV**\\n**IG1qdJpB1J5O&#x2F;kCLsGcTf7RS74MtqMFo96446Zvt7YaBhWPz6gDaO&#x2F;TUzfrNcGLA**\\n**EfHVXkvVWqb3gqXUztZyVex&#x2F;gtP9FXQ7gxTvJml7UkmT0VAFjtZnCqmFxpLZFZ15**\\n**+qP9O7Q2MpsGUO&#x2F;4vDAuYrKBeg1ZdPSi8gwqUP2qWsGd9MIWRv3thI2903BczDc7**\\n**r8WaIbm37vYZAS9G56E4+wIDAQABo1AwTjAdBgNVHQ4EFgQUugLrSJshOBk5TSsU**\\n**ANs4+SmJUGwwHwYDVR0jBBgwFoAUugLrSJshOBk5TSsUANs4+SmJUGwwDAYDVR0T**\\n**BAUwAwEB&#x2F;zANBgkqhkiG9w0BAQUFAAOCAQEAaMJ33zAMV4korHo5aPfayV3uHoYZ**\\n**1ChzP3eSsF+FjoscpoNSKs91ZXZF6LquzoNezbfiihK4PYqgwVD2+O0&#x2F;Ty7UjN4S**\\n**qzFKVR4OS&#x2F;6lCJ8YncxoFpTntbvjgojf1DEataKFUN196PAANc3yz8cWHF4uvjPv**\\n**WkgFqbIjb+7D1YgglNyovXkRDlRZl0LD1OQ0ZWhd4Ge1qx8mmmanoBeYZ9+DgpFC**\\n**j9tQAbS867yeOryNe7sEOIpXAAqK&#x2F;DTu0hB6+ySsDfMo4piXCc2aA&#x2F;eI2DCuw08e**\\n**w17Dz9WnupZjVdwTKzDhFgJZMLDqn37HQnT6EemLFqbcR0VPEnfyhDtZIQ&#x3D;&#x3D;**\\n**\-----END CERTIFICATE-----&quot;</span><br><span class="line"></span><br><span class="line">        **&#125;**</span><br><span class="line"></span><br><span class="line">      **&#125;**</span><br><span class="line"></span><br><span class="line">    **&#125;,**</span><br><span class="line"></span><br><span class="line">    **&#123;**</span><br><span class="line"></span><br><span class="line">      &quot;kind&quot;**:** &quot;PersistentVolumeClaim&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;apiVersion&quot;**:** &quot;v1&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;metadata&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;name&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;&quot;</span><br><span class="line"></span><br><span class="line">      **&#125;,**</span><br><span class="line"></span><br><span class="line">      &quot;spec&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;accessModes&quot;**: \[**</span><br><span class="line"></span><br><span class="line">          &quot;ReadWriteOnce&quot;</span><br><span class="line"></span><br><span class="line">        **\],**</span><br><span class="line"></span><br><span class="line">        &quot;resources&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">          &quot;requests&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">            &quot;storage&quot;**:** &quot;$&#123;VOLUME\_CAPACITY&#125;&quot;</span><br><span class="line"></span><br><span class="line">          **&#125;**</span><br><span class="line"></span><br><span class="line">        **&#125;**</span><br><span class="line"></span><br><span class="line">      **&#125;**</span><br><span class="line"></span><br><span class="line">    **&#125;,**   </span><br><span class="line"></span><br><span class="line">    **&#123;**</span><br><span class="line"></span><br><span class="line">      &quot;kind&quot;**:** &quot;DeploymentConfig&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;apiVersion&quot;**:** &quot;v1&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;metadata&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;name&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;&quot;**,**</span><br><span class="line"></span><br><span class="line">        &quot;creationTimestamp&quot;**:** null</span><br><span class="line"></span><br><span class="line">      **&#125;,**</span><br><span class="line"></span><br><span class="line">      &quot;spec&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">        &quot;strategy&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">          &quot;type&quot;**:** &quot;Recreate&quot;**,**</span><br><span class="line"></span><br><span class="line">          &quot;resources&quot;**: &#123;&#125;**</span><br><span class="line"></span><br><span class="line">        **&#125;,**</span><br><span class="line"></span><br><span class="line">        &quot;triggers&quot;**: \[**</span><br><span class="line"></span><br><span class="line">          **&#123;**</span><br><span class="line"></span><br><span class="line">            &quot;type&quot;**:** &quot;ImageChange&quot;**,**</span><br><span class="line"></span><br><span class="line">            &quot;imageChangeParams&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">              &quot;automatic&quot;**:** **true,**</span><br><span class="line"></span><br><span class="line">              &quot;containerNames&quot;**: \[**</span><br><span class="line"></span><br><span class="line">                &quot;jenkins&quot;</span><br><span class="line"></span><br><span class="line">              **\],**</span><br><span class="line"></span><br><span class="line">              &quot;from&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">                &quot;kind&quot;**:** &quot;ImageStreamTag&quot;**,**</span><br><span class="line"></span><br><span class="line">                &quot;name&quot;**:** &quot;jenkins-1-centos7:latest&quot;**,**</span><br><span class="line"></span><br><span class="line">                &quot;namespace&quot;**:** &quot;openshift&quot;</span><br><span class="line"></span><br><span class="line">              **&#125;,**</span><br><span class="line"></span><br><span class="line">              &quot;lastTriggeredImage&quot;**:** &quot;&quot;</span><br><span class="line"></span><br><span class="line">            **&#125;**</span><br><span class="line"></span><br><span class="line">          **&#125;,**</span><br><span class="line"></span><br><span class="line">          **&#123;**</span><br><span class="line"></span><br><span class="line">            &quot;type&quot;**:** &quot;ConfigChange&quot;</span><br><span class="line"></span><br><span class="line">          **&#125;**</span><br><span class="line"></span><br><span class="line">        **\],**</span><br><span class="line"></span><br><span class="line">        &quot;replicas&quot;**:** **1,**</span><br><span class="line"></span><br><span class="line">        &quot;selector&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">          &quot;name&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;&quot;</span><br><span class="line"></span><br><span class="line">        **&#125;,**</span><br><span class="line"></span><br><span class="line">        &quot;template&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">          &quot;metadata&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">            &quot;creationTimestamp&quot;**:** null**,**</span><br><span class="line"></span><br><span class="line">            &quot;labels&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">              &quot;name&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;&quot;</span><br><span class="line"></span><br><span class="line">            **&#125;**</span><br><span class="line"></span><br><span class="line">          **&#125;,**</span><br><span class="line"></span><br><span class="line">          &quot;spec&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">            &quot;containers&quot;**: \[**</span><br><span class="line"></span><br><span class="line">              **&#123;**</span><br><span class="line"></span><br><span class="line">                &quot;name&quot;**:** &quot;jenkins&quot;**,**</span><br><span class="line"></span><br><span class="line">                &quot;image&quot;**:** &quot;$&#123;JENKINS\_IMAGE&#125;&quot;**,**</span><br><span class="line"></span><br><span class="line">                &quot;env&quot;**: \[**</span><br><span class="line"></span><br><span class="line">                  **&#123;**</span><br><span class="line"></span><br><span class="line">                    &quot;name&quot;**:** &quot;JENKINS\_PASSWORD&quot;**,**</span><br><span class="line"></span><br><span class="line">                    &quot;value&quot;**:** &quot;$&#123;JENKINS\_PASSWORD&#125;&quot;</span><br><span class="line"></span><br><span class="line">                  **&#125;**</span><br><span class="line"></span><br><span class="line">                **\],**</span><br><span class="line"></span><br><span class="line">                &quot;resources&quot;**: &#123;&#125;,**</span><br><span class="line"></span><br><span class="line">                &quot;volumeMounts&quot;**: \[**</span><br><span class="line"></span><br><span class="line">                  **&#123;**</span><br><span class="line"></span><br><span class="line">                    &quot;name&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;-data&quot;**,**</span><br><span class="line"></span><br><span class="line">                    &quot;mountPath&quot;**:** &quot;&#x2F;var&#x2F;lib&#x2F;jenkins&quot;</span><br><span class="line"></span><br><span class="line">                  **&#125;**</span><br><span class="line"></span><br><span class="line">                **\],**</span><br><span class="line"></span><br><span class="line">                &quot;terminationMessagePath&quot;**:** &quot;&#x2F;dev&#x2F;termination-log&quot;**,**</span><br><span class="line"></span><br><span class="line">                &quot;imagePullPolicy&quot;**:** &quot;IfNotPresent&quot;**,**</span><br><span class="line"></span><br><span class="line">                &quot;capabilities&quot;**: &#123;&#125;,**</span><br><span class="line"></span><br><span class="line">                &quot;securityContext&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">                  &quot;capabilities&quot;**: &#123;&#125;,**</span><br><span class="line"></span><br><span class="line">                  &quot;privileged&quot;**:** **false**</span><br><span class="line"></span><br><span class="line">                **&#125;**</span><br><span class="line"></span><br><span class="line">              **&#125;**</span><br><span class="line"></span><br><span class="line">            **\],**</span><br><span class="line"></span><br><span class="line">            &quot;volumes&quot;**: \[**</span><br><span class="line"></span><br><span class="line">              **&#123;**</span><br><span class="line"></span><br><span class="line">                &quot;name&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;-data&quot;**,**</span><br><span class="line"></span><br><span class="line">                &quot;persistentVolumeClaim&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">                  &quot;claimName&quot;**:** &quot;$&#123;JENKINS\_SERVICE\_NAME&#125;&quot;</span><br><span class="line"></span><br><span class="line">                **&#125;**</span><br><span class="line"></span><br><span class="line">              **&#125;**</span><br><span class="line"></span><br><span class="line">            **\],**</span><br><span class="line"></span><br><span class="line">            &quot;restartPolicy&quot;**:** &quot;Always&quot;**,**</span><br><span class="line"></span><br><span class="line">            &quot;dnsPolicy&quot;**:** &quot;ClusterFirst&quot;</span><br><span class="line"></span><br><span class="line">          **&#125;**</span><br><span class="line"></span><br><span class="line">        **&#125;**</span><br><span class="line"></span><br><span class="line">      **&#125;**</span><br><span class="line"></span><br><span class="line">    **&#125;**</span><br><span class="line"></span><br><span class="line">  **\],**</span><br><span class="line"></span><br><span class="line">  &quot;parameters&quot;**: \[**</span><br><span class="line"></span><br><span class="line">    **&#123;**</span><br><span class="line"></span><br><span class="line">      &quot;name&quot;**:** &quot;JENKINS\_SERVICE\_NAME&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;description&quot;**:** &quot;Jenkins service name&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;value&quot;**:** &quot;jenkins&quot;</span><br><span class="line"></span><br><span class="line">    **&#125;,**</span><br><span class="line"></span><br><span class="line">    **&#123;**</span><br><span class="line"></span><br><span class="line">      &quot;name&quot;**:** &quot;JENKINS\_PASSWORD&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;description&quot;**:** &quot;Password for the Jenkins user&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;generate&quot;**:** &quot;expression&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;value&quot;**:** &quot;password&quot;</span><br><span class="line"></span><br><span class="line">    **&#125;,**</span><br><span class="line"></span><br><span class="line">    **&#123;**</span><br><span class="line"></span><br><span class="line">      &quot;name&quot;**:** &quot;VOLUME\_CAPACITY&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;description&quot;**:** &quot;Volume space available for data, e.g. 512Mi, 2Gi&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;value&quot;**:** &quot;512Mi&quot;**,**</span><br><span class="line"></span><br><span class="line">      &quot;required&quot;**:** **true**</span><br><span class="line"></span><br><span class="line">    **&#125;**</span><br><span class="line"></span><br><span class="line">  **\],**</span><br><span class="line"></span><br><span class="line">  &quot;labels&quot;**: &#123;**</span><br><span class="line"></span><br><span class="line">    &quot;template&quot;**:** &quot;jenkins-persistent-template&quot;</span><br><span class="line"></span><br><span class="line">  **&#125;**</span><br><span class="line"></span><br><span class="line">**&#125;**</span><br></pre></td></tr></table></figure>
<h3 id="Route使用"><a href="#Route使用" class="headerlink" title="Route使用"></a>Route使用</h3><p>Route提供了外部访问服务的能力，此时需要外部dns的支持，dns的进行地址解析需要配置到haproxy-rouer所在的node节点IP</p>
<p>登录到haproxy-route所在的容器查看配置信息，确认是将每个应用的pod的IP地址配置到了haproxy的配置文件，完成负载均衡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">backend be\_http\_demo\_django-psql-example</span><br><span class="line"></span><br><span class="line">  mode http</span><br><span class="line"></span><br><span class="line">  option redispatch</span><br><span class="line"></span><br><span class="line">  option forwardfor</span><br><span class="line"></span><br><span class="line">  balance leastconn</span><br><span class="line"></span><br><span class="line">  timeout check **5000**ms</span><br><span class="line"></span><br><span class="line">  http-request set-header X-Forwarded-Host **%\[**req**.**hdr**(**host**)\]**</span><br><span class="line"></span><br><span class="line">  http-request set-header X-Forwarded-Port **%\[**dst\_port**\]**</span><br><span class="line"></span><br><span class="line">  http-request set-header X-Forwarded-Proto https if **&#123;** ssl\_fc **&#125;**</span><br><span class="line"></span><br><span class="line">    cookie OPENSHIFT\_demo\_django-psql-example\_SERVERID insert indirect nocache httponly</span><br><span class="line"></span><br><span class="line">    http-request set-header X-Forwarded-Proto http</span><br><span class="line"></span><br><span class="line">  http-request set-header Forwarded for**\&#x3D;%\[**src**\],**host**\&#x3D;%\[**req**.**hdr**(**host**)\],**proto**\&#x3D;%\[**req**.**hdr**(**X-Forwarded-Proto**)\]**</span><br><span class="line"></span><br><span class="line">  server **10.1.0.3:8080 10.1.0.3:8080** check inter **5000**ms cookie **10.1.0.3:8080**</span><br><span class="line"></span><br><span class="line">backend be\_http\_demo\_jenkins</span><br><span class="line"></span><br><span class="line">  mode http</span><br><span class="line"></span><br><span class="line">  option redispatch</span><br><span class="line"></span><br><span class="line">  option forwardfor</span><br><span class="line"></span><br><span class="line">  balance leastconn</span><br><span class="line"></span><br><span class="line">  timeout check **5000**ms</span><br><span class="line"></span><br><span class="line">  http-request set-header X-Forwarded-Host **%\[**req**.**hdr**(**host**)\]**</span><br><span class="line"></span><br><span class="line">  http-request set-header X-Forwarded-Port **%\[**dst\_port**\]**</span><br><span class="line"></span><br><span class="line">  http-request set-header X-Forwarded-Proto https if **&#123;** ssl\_fc **&#125;**</span><br><span class="line"></span><br><span class="line">    cookie OPENSHIFT\_demo\_jenkins\_SERVERID insert indirect nocache httponly</span><br><span class="line"></span><br><span class="line">    http-request set-header X-Forwarded-Proto http</span><br><span class="line"></span><br><span class="line">  http-request set-header Forwarded for**\&#x3D;%\[**src**\],**host**\&#x3D;%\[**req**.**hdr**(**host**)\],**proto**\&#x3D;%\[**req**.**hdr**(**X-Forwarded-Proto**)\]**</span><br><span class="line"></span><br><span class="line">  server **10.1.1.20:8080 10.1.1.20:8080** check inter **5000**ms cookie **10.1.1.20:8080**</span><br></pre></td></tr></table></figure>
<h4 id="DNS-配置"><a href="#DNS-配置" class="headerlink" title="DNS 配置"></a>DNS 配置</h4><p>DNS是基于ubuntu14.04 部署了bind9，参考配置：192.168.10.149为haproxy-router所在的节点IP（运行haproxy-router的容器所在的节点IP）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">root@origin**\-**dns**:&#x2F;**etc**&#x2F;**bind# cat **&#x2F;**etc**&#x2F;**bind**&#x2F;**named**.**conf**.**local</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Do any local configuration here</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Consider adding the 1918 zones here, if they are not used in your</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; organization</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;include &quot;&#x2F;etc&#x2F;bind&#x2F;zones.rfc1918&quot;;</span><br><span class="line"></span><br><span class="line">zone &quot;novalocal&quot; **&#123;**</span><br><span class="line"></span><br><span class="line">        **type** master**;**</span><br><span class="line"></span><br><span class="line">        file &quot;&#x2F;etc&#x2F;bind&#x2F;db.novalocal&quot;**;**</span><br><span class="line"></span><br><span class="line">**&#125;;**</span><br><span class="line"></span><br><span class="line">zone  &quot;devops.inspur&quot; **&#123;** </span><br><span class="line"></span><br><span class="line">     **type** master**;** </span><br><span class="line"></span><br><span class="line">     file &quot;&#x2F;etc&#x2F;bind&#x2F;db.devops.inspur&quot;**;** </span><br><span class="line"></span><br><span class="line">**&#125;;** </span><br><span class="line"></span><br><span class="line">zone  &quot;10.168.192.in-addr.arpa&quot; **&#123;** </span><br><span class="line"></span><br><span class="line">     **type** master**;** </span><br><span class="line"></span><br><span class="line">     file &quot;&#x2F;etc&#x2F;bind&#x2F;db.17.110.10&quot;**;** </span><br><span class="line"></span><br><span class="line">**&#125;;**</span><br><span class="line"></span><br><span class="line">cat db**.**devops**.**inspur</span><br><span class="line"></span><br><span class="line">**;** </span><br><span class="line"></span><br><span class="line">**;** BIND data file for dev sites </span><br><span class="line"></span><br><span class="line">**;** </span><br><span class="line"></span><br><span class="line">$TTL    **604800** </span><br><span class="line"></span><br><span class="line">@       IN      SOA     devops**.**inspur**.** root**.**devops**.**inspur**. (** </span><br><span class="line"></span><br><span class="line">                              **3**         **;** Serial </span><br><span class="line"></span><br><span class="line">                         **604800**         **;** Refresh </span><br><span class="line"></span><br><span class="line">                          **86400**         **;** Retry  </span><br><span class="line"></span><br><span class="line">                        **2419200**         **;** Expire </span><br><span class="line"></span><br><span class="line">                         **604800** **)       ;** Negative Cache TTL </span><br><span class="line"></span><br><span class="line">**;** </span><br><span class="line"></span><br><span class="line">@       IN      NS      devops**.**inspur**.** </span><br><span class="line"></span><br><span class="line">@       IN      A       **10.110.17.131**</span><br><span class="line"></span><br><span class="line">**\*.**devops**.**inspur**.**  **14400**   IN      A       **10.110.17.131**</span><br><span class="line"></span><br><span class="line">root@origin**\-**dns**:&#x2F;**etc**&#x2F;**bind# cat db.17.110.10</span><br><span class="line"></span><br><span class="line">**;** </span><br><span class="line"></span><br><span class="line">**;** BIND reverse data file for dev domains </span><br><span class="line"></span><br><span class="line">**;** </span><br><span class="line"></span><br><span class="line">$TTL    **604800** </span><br><span class="line"></span><br><span class="line">@       IN      SOA     dev**.** root**.**dev**. (** </span><br><span class="line"></span><br><span class="line">                              **3**         **;** Serial </span><br><span class="line"></span><br><span class="line">                         **604800**         **;** Refresh </span><br><span class="line"></span><br><span class="line">                          **86400**         **;** Retry </span><br><span class="line"></span><br><span class="line">                        **2419200**         **;** Expire </span><br><span class="line"></span><br><span class="line">                         **604800** **)       ;** Negative Cache TTL </span><br><span class="line"></span><br><span class="line">**;** </span><br><span class="line"></span><br><span class="line">@        IN      NS      devops**.**inspur**.** </span><br><span class="line"></span><br><span class="line">**149**      IN      PTR     devops**.**inspur**.**</span><br></pre></td></tr></table></figure>

<p>获取部署的应用对应的Router</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">**\[**root@origin**\-**master image-streams**\]**\# oc get route **\-**n demo</span><br><span class="line"></span><br><span class="line">NAME               HOST**&#x2F;**PORT                            PATH      SERVICE            LABELS                      INSECURE POLICY   TLS TERMINATION</span><br><span class="line"></span><br><span class="line">django-psql-test   www**.**django-psql-test**.**devops**.**inspur             django-psql-test   template**\&#x3D;**django-psql-test</span><br></pre></td></tr></table></figure>
<p>windows或者linux配置dns地址就可以访问该应用</p>
<h2 id="S2I"><a href="#S2I" class="headerlink" title="S2I"></a>S2I</h2><p>参考（<a href="https://github.com/openshift/source-to-image%EF%BC%89" target="_blank" rel="noopener">https://github.com/openshift/source-to-image）</a></p>
<p>简单了解了S2I的思路，类似CloudFoundry的BuildPack，S2I基于build image+source code，使用脚本将源码打入build image，作为应用的docker image。这里的build image 类似CloudFoundry的buildpack，build image里面内置了应用的运行环境例如tomcat、jre、nginx</p>
<p>例如运行python程序的buil image</p>
<p><a href="https://github.com/openshift/sti-python/tree/master/2.7" target="_blank" rel="noopener">https://github.com/openshift/sti-python/tree/master/2.7</a></p>
<p><img src="file://C:/Users/wangd/AppData/Local/Temp/msohtmlclip1/01/clip_image005.jpg"></p>
<p>制作Build Image的DockerFile：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">FROM openshift**&#x2F;**base-centos7</span><br><span class="line"></span><br><span class="line">\# This image provides a Python **2.7** environment you can use to run your Python</span><br><span class="line"></span><br><span class="line">\# applications**.**</span><br><span class="line"></span><br><span class="line">MAINTAINER SoftwareCollections**.**org **&lt;**sclorg@redhat**.**com**\&gt;**</span><br><span class="line"></span><br><span class="line">EXPOSE **8080**</span><br><span class="line"></span><br><span class="line">ENV PYTHON\_VERSION**\&#x3D;****2.7** \\</span><br><span class="line"></span><br><span class="line">    PATH**\&#x3D;**$HOME**&#x2F;.**local**&#x2F;**bin**&#x2F;:**$PATH</span><br><span class="line"></span><br><span class="line">LABEL io**.**k8s**.****description****\&#x3D;**&quot;Platform for building and running Python 2.7 applications&quot; \\</span><br><span class="line"></span><br><span class="line">      io**.**k8s**.**display-name**\&#x3D;**&quot;Python 2.7&quot; \\</span><br><span class="line"></span><br><span class="line">      io**.**openshift**.**expose-services**\&#x3D;**&quot;8080:http&quot; \\</span><br><span class="line"></span><br><span class="line">      io**.**openshift**.**tags**\&#x3D;**&quot;builder,python,python27,rh-python27&quot;</span><br><span class="line"></span><br><span class="line">RUN yum install **\-**y centos-release-scl **&amp;&amp;** \\</span><br><span class="line"></span><br><span class="line">    yum install **\-**y **\--**setopt**\&#x3D;**tsflags**\&#x3D;**nodocs **\--**enablerepo**\&#x3D;**centosplus python27 python27-python-devel python27-python-setuptools python27-python-pip epel-release **&amp;&amp;** \\</span><br><span class="line"></span><br><span class="line">    yum install **\-**y **\--**setopt**\&#x3D;**tsflags**\&#x3D;**nodocs install nss\_wrapper **&amp;&amp;** \\</span><br><span class="line"></span><br><span class="line">    yum clean all **\-**y</span><br><span class="line"></span><br><span class="line">\# Copy the S2I scripts from the specific language image to $STI\_SCRIPTS\_PATH</span><br><span class="line"></span><br><span class="line">COPY **.&#x2F;**s2i**&#x2F;**bin**&#x2F;** $STI\_SCRIPTS\_PATH</span><br><span class="line"></span><br><span class="line">\# Each language image can have &#39;contrib&#39; a directory with extra files needed to</span><br><span class="line"></span><br><span class="line">\# run and build the applications**.**</span><br><span class="line"></span><br><span class="line">COPY **.&#x2F;**contrib**&#x2F; &#x2F;**opt**&#x2F;**app-root</span><br><span class="line"></span><br><span class="line">RUN chown **\-**R **1001:0** **&#x2F;**opt**&#x2F;**app-root **&amp;&amp;** chmod **\-**R og**+**rwx **&#x2F;**opt**&#x2F;**app-root</span><br><span class="line"></span><br><span class="line">USER **1001**</span><br><span class="line"></span><br><span class="line">\# Set the **default** CMD to print the usage of the language image</span><br><span class="line"></span><br><span class="line">CMD $STI\_SCRIPTS\_PATH**&#x2F;**usage</span><br></pre></td></tr></table></figure>
<p>不同开发环境需要提供不同的build image，如果同一开发环境下，应用对运行环境需求不同，也需要开发不同的build image。</p>
<p>S2I 虽然简化了应用部署的流程，但是增加了更多的定制化过程。</p>
<p>建议使用场景：平台提供固定的几种build image。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/15/OpenStack-%E6%BA%90%E7%A0%81%E4%B8%AD%E7%9A%84OSLO/" rel="next" title="OpenStack 源码中的OSLO">
                <i class="fa fa-chevron-left"></i> OpenStack 源码中的OSLO
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/09/21/Nginx%E4%BB%A3%E7%90%86%E7%AB%AF%E5%8F%A3%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98/" rel="prev" title="Nginx代理端口丢失问题">
                Nginx代理端口丢失问题 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">54</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/davidstack" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
            </div>
          

          
          

          
          

          
        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#OpenShift"><span class="nav-number">1.</span> <span class="nav-text">OpenShift</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#OpenShift-分布式部署"><span class="nav-number">1.1.</span> <span class="nav-text">OpenShift 分布式部署</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#OpenShift-Slave节点配置"><span class="nav-number">1.1.1.</span> <span class="nav-text">OpenShift Slave节点配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OpenShift-Master节点配置"><span class="nav-number">1.1.2.</span> <span class="nav-text">OpenShift Master节点配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#执行安装"><span class="nav-number">1.1.3.</span> <span class="nav-text">执行安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#部署Docker-Registry"><span class="nav-number">1.1.4.</span> <span class="nav-text">部署Docker-Registry</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#部署监控metrics"><span class="nav-number">1.1.5.</span> <span class="nav-text">部署监控metrics</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#部署Route"><span class="nav-number">1.1.6.</span> <span class="nav-text">部署Route</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#外部Docker-Registry搭建"><span class="nav-number">1.2.</span> <span class="nav-text">外部Docker-Registry搭建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#管理OpenShift"><span class="nav-number">1.3.</span> <span class="nav-text">管理OpenShift</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#导入镜像"><span class="nav-number">1.3.1.</span> <span class="nav-text">导入镜像</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、从第三方仓库导入镜像"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">1、从第三方仓库导入镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、登录OpenShift-内部docker-registry，导入镜像"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">2、登录OpenShift 内部docker-registry，导入镜像</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#部署Template"><span class="nav-number">1.3.2.</span> <span class="nav-text">部署Template</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Deployment"><span class="nav-number">1.3.3.</span> <span class="nav-text">Deployment</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#持久化存储-PersistentVolume"><span class="nav-number">1.3.4.</span> <span class="nav-text">持久化存储 PersistentVolume </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Route使用"><span class="nav-number">1.3.5.</span> <span class="nav-text">Route使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DNS-配置"><span class="nav-number">1.3.5.1.</span> <span class="nav-text">DNS 配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#S2I"><span class="nav-number">1.4.</span> <span class="nav-text">S2I</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DavidStack</span>

  
</div>









        
<div class="busuanzi-count">
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

</body>
</html>
